(this["webpackChunktzw_live_watch"]=this["webpackChunktzw_live_watch"]||[]).push([[42],{2719:(e,t,a)=>{"use strict";a.d(t,{A:()=>f});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("el-form",{staticClass:"filter-container",attrs:{inline:"","label-width":"90px",size:"mini"}},[t("el-form-item",{staticClass:"filter-item",attrs:{label:"日期"}},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.searchData.date,callback:function(t){e.$set(e.searchData,"date",t)},expression:"searchData.date"}})],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"团队",prop:"teamId"}},[t("UserTreeSelector",{ref:"userTreeSelector",attrs:{popover:"",selectTeam:"",singleSelect:"",confirmOnSelect:"",visible:e.showUserSelector,selectedValue:e.selectedValue},on:{"update:visible":function(t){e.showUserSelector=t},confirm:e.onTeamUserSelected}},[t("template",{slot:"reference"},[t("el-input",{staticClass:"mr10",staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:"请选择团队",clearable:""},on:{clear:e.clearSelectedUser},model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}})],1)],2)],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:""}},[t("el-button",{attrs:{type:"primary"},on:{click:e.handleCheck}},[e._v("查询")]),t("el-button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1),t("div",{staticClass:"hour-table"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.peakLabs,"element-loading-text":"拼命计算中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",stripe:"",border:"",size:"small"}},[t("el-table-column",{attrs:{fixed:"",align:"center",label:"条目 \\ 时",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.name))])]}}])}),e._l(e.tableDataHoursRowLabel,function(a,s){return e.loading?e._e():t("el-table-column",{key:s,attrs:{label:a.time,align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return["peak"==s.row.type?t("span",[e._v(" "+e._s(e.getMaxPeakCount(e.searchData.date+"T"+(2==(""+a.time).length?"":"0")+parseInt(a.time)+":00",e.searchData.date+"T"+(""+a.time.length==2?"":"0")+a.time+":59","h"))+" ")]):e._e(),"ip"==s.row.type?t("span",[e._v(" "+e._s(e.getIpCount(e.searchData.date+"T"+(2==(""+a.time).length?"":"0")+parseInt(a.time)))+" ")]):e._e()]}}],null,!0)})})],2)],1),t("div",{staticClass:"option-tab-panel"},[t("div",{staticClass:"option-tab-panel-item",class:e.showChart?"active":"",on:{click:function(t){e.showChart=!0}}},[e._v("图表")]),t("div",{staticClass:"option-tab-panel-item",class:e.showChart?"":"active",on:{click:function(t){e.showChart=!1}}},[e._v("数据表")])]),!e.loading&&e.showChart?t("div",[t("el-select",{attrs:{filterable:"",placeholder:"选择时间段"},on:{change:e.displayChart},model:{value:e.chartsTimeRange,callback:function(t){e.chartsTimeRange=t},expression:"chartsTimeRange"}},e._l(e.opts.timeRange,function(e,a){return t("el-option",{key:"time_range_indx_"+a,attrs:{label:e,value:e}})}),1),t("div",{ref:"chart1",style:{width:"100%",height:"600px"},attrs:{id:"chart1"}})],1):e._e(),e.loading||e.showChart?e._e():t("div",{staticClass:"hour-table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableDataHoursRowLabel,stripe:"",border:"",size:"small"}},[t("el-table-column",{attrs:{fixed:"",align:"center",label:"时 \\ 分",width:"60"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.time))])]}}],null,!1,1740237331)}),e._l(e.tableData5MCols,function(a,s){return t("el-table-column",{key:s,attrs:{label:a+"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(" "+e._s(e.getMaxPeakCount(e.searchData.date+"T"+(2==(""+s.row.time).length?"":"0")+parseInt(s.row.time)+":"+(2==(""+(a-5>=0?a-5:0)).length?"":"0")+(a-5>=0?a-5:0),e.searchData.date+"T"+(2==(""+s.row.time).length?"":"0")+parseInt(s.row.time)+":"+(2==(""+(a-1)).length?"":"0")+(a-1),"5m"))+" ")])]}}],null,!0)})})],2)],1),e.loading||e.showChart?e._e():t("div",{staticClass:"hour-table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableDataHoursRowLabel,stripe:"",border:"",size:"small"}},[t("el-table-column",{attrs:{fixed:"",align:"center",label:"时 \\ 分",width:"60"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.time))])]}}],null,!1,1740237331)}),e._l(e.tableData1MCols,function(a,s){return t("el-table-column",{key:s,attrs:{label:a+"",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(" "+e._s(e.getPeakCount(e.searchData.date+"T"+(2==(""+s.row.time).length?"":"0")+parseInt(s.row.time)+":"+(2==(""+(a-1)).length?"":"0")+(a-1)))+" ")])]}}],null,!0)})})],2)],1)],1)},i=[],r=(a(44114),a(18111),a(22489),a(7588),a(79187)),l=a(52112),o=a(96208),n=a(95353),d=a(62978),c=a(88605);function u(e,t,a=1,s=0){let i=[];e=parseInt(e),t=parseInt(t),s&&t++;for(let r=e;r<t;r+=a)i.push({time:""+r});return i}const h={name:"Hours",components:{UserTreeSelector:r.A},data(){return{selectedValue:void 0,showUserSelector:!1,tableData1MCols:Array.from({length:60},(e,t)=>t+1),tableData5MCols:Array.from({length:12},(e,t)=>5*(t+1)),tableDataHoursRowLabel:[],peakLabs:[],ipCounts:[],peakCounts:[],loading:!1,page:{beginPageIndex:1,pageCurrent:1,endPageIndex:8,pageSize:20,totalCount:0,totalPage:0},opts:{roomList:[],timeRange:["全部","8:00-12:00","13:00-16:00","16:00-18:00","18:00-21:00"]},searchData:{date:"",timeBegin:"08:00:00",timeEnd:"23:59:59",roomId:null,team:{}},showChart:!0,chartsTimeRange:"18:00-21:00"}},computed:{...(0,n.L8)(["getUserInfo","getLiveRoomInfo"])},created(){function e(){const e=new Date,t=e.getFullYear();let a=e.getMonth()+1,s=e.getDate();return a=a<10?"0"+a:a,s=s<10?"0"+s:s,`${t}-${a}-${s}`}let t=this.$route.query.date;this.searchData.date=t||e();let a=this.$route.query.roomId;a&&(this.searchData.roomId=a);let s=this.$route.query.deptId;s&&(this.searchData.team={type:"team",id:s}),this.peakLabs=[{name:"人数",type:"ip"},{name:"峰值",type:"peak"}]},mounted(){this.searchData.roomId=this.getLiveRoomInfo.id,2!=this.getUserInfo.type||this.getUserInfo.actForUser?this.getUserInfo.actForUser&&2==this.getUserInfo.actForUser.type&&(this.searchData.parentId=this.getUserInfo.actForUser.userId):this.searchData.parentId=this.getUserInfo.userId},watch:{showChart(e){e&&this.displayChart()}},methods:{clearSelectedUser(){this.selectedValue=void 0,this.searchData.userId=void 0,this.searchData.deptId=void 0,this.$refs.userTreeSelector&&this.$refs.userTreeSelector.clearSelected&&this.$refs.userTreeSelector.clearSelected()},onTeamUserSelected(e){e?e.selected&&(e.selected.__isUser?(this.searchData.userId=e.selected.userId,this.selectedValue=e.selected.userName,this.searchData.deptId=void 0):(this.searchData.deptId=e.selected.deptId,this.selectedValue=e.selected.deptName,this.searchData.userId=void 0)):this.selectedValue=void 0,this.showUserSelector=!1},resetLabels(){this.tableDataHoursRowLabel.splice(0,this.tableDataHoursRowLabel.length);let e=this.searchData.timeBegin.split(":"),t=this.searchData.timeEnd.split(":"),a=(0,l.qw)(new Date,"yyyy-MM-ddTHH"),s=(0,l.qw)(new Date,"HH");t[0]=this.searchData.date+"T"+t[0]>a?s:t[0];let i=u(e[0],t[0],1,parseInt(t[1]));this.tableDataHoursRowLabel.splice(0,0,...i)},handleReset(){this.searchData={date:"",timeBegin:"08:00:00",timeEnd:"23:59:59",roomId:"",team:{}},this.resetLabels()},handleCheck(){this.page.pageCurrent=1,this.fetchData()},displayChart(){let e=this;e.$nextTick(()=>{let t=c.Ts(e.$refs.chart1);t.showLoading();let a={label:[],series:[{name:"访问量",data:[],type:"line",symbol:"circle",smooth:!0,symbolSize:8,itemStyle:{normal:{label:{show:!0},color:"#ff95a2",lineStyle:{width:2,type:"solid",color:"#4fd6d2"}}},areaStyle:{normal:{color:new c.fA.W4(0,0,0,1,[{offset:0,color:"#dffff9"},{offset:.5,color:"#eefdfa"},{offset:1,color:"#ffffff"}])}}}]},s=e.tableDataHoursRowLabel;switch(e.chartsTimeRange){case"8:00-12:00":s=u(8,12,1,1);break;case"13:00-16:00":s=u(13,16,1,1);break;case"16:00-18:00":s=u(16,18,1,1);break;case"18:00-21:00":s=u(18,21,1,1);break}for(let o in s){let t=s[o];for(let s in e.tableData1MCols){let i=e.tableData1MCols[s],r=e.searchData.date+"T"+(2==(""+t.time).length?"":"0")+parseInt(t.time)+":"+(2==(""+(i-1)).length?"":"0")+(i-1),l=(0,d.pe)(new Date(r),"{h}:{i}"),o=e.getPeakCount(r);a.label.push(l),a.series[0].data.push(o)}}let i=a.label,r=a.series,l={title:{text:"用户访问量趋势图",x:"center"},legend:{show:!0,orient:"horizontal",x:"right",y:"top"},grid:{top:"10%",left:"1%",right:"5%",bottom:"20%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross",axis:"auto",snap:!0},showContent:!0},xAxis:{name:"时间",type:"category",data:i,axisTick:{show:!0},axisLine:{lineStyle:{color:"#3366CC"}},axisLabel:{rotate:45,interval:"全部"==e.chartsTimeRange?19:9}},yAxis:{name:"用户访问量",type:"value",axisTick:{show:!0},splitLine:{show:!1},axisLine:{show:!0,lineStyle:{color:"#3366CC"}}},series:r,color:["#FFCC99"]};t.setOption(l),t.hideLoading()})},fetchData(){let e=this;if(this.tableDataHoursRowLabel.splice(0,this.tableDataHoursRowLabel.length),e.$set(e,"ipCounts",{}),e.$set(e,"peakCounts",{}),!this.searchData.roomId||""==this.searchData.roomId.trim())return void this.$message.error("请选择直播间！");if(!this.searchData.date||""==this.searchData.date.trim())return void this.$message.error("请选择日期！");e.loading=!0;let t={date:this.searchData.date+" "+this.searchData.timeBegin,hourFrom:this.searchData.date+" "+this.searchData.timeBegin,hourEnd:this.searchData.date+" "+this.searchData.timeEnd,roomId:this.searchData.roomId,deptId:this.searchData.deptId,userId:this.searchData.userId};t.deptId||t.userId||!this.getUserInfo.actForUser||2==this.getUserInfo.actForUser.type&&(t["userId"]=this.getUserInfo.actForUser.userId),(0,o.c$)(t).then(t=>{t.data.minutes&&t.data.hours&&(e.ipCounts=t.data.hours,e.peakCounts=t.data.minutes),e.resetLabels(),setTimeout(()=>{e.loading=!1,e.showChart&&e.displayChart()},50)}).catch(t=>{e.loading=!1,console.error(t)})},getIpCount(e){return e>(0,l.qw)(new Date,"yyyy-MM-ddTHH")?"-":Number(this.ipCounts[e]||0)},getPeakCount(e){return e>(0,l.qw)(new Date,"yyyy-MM-ddTHH:mm")?"-":Number(this.peakCounts[e]||0)},getMaxPeakCount(e,t,a){let s=this,i=Object.keys(s.peakCounts).filter(a=>a>=e&&a<=t),r=0,o=(0,l.qw)(new Date,"yyyy-MM-ddTHH:mm");return e>o?"-":(i.forEach(e=>{r<Number(s.peakCounts[e])&&(r=Number(s.peakCounts[e]))}),r)}}},m=h;var p=a(81656),g=(0,p.A)(m,s,i,!1,null,"9ee280b8",null);const f=g.exports},29699:(e,t,a)=>{"use strict";a.d(t,{A:()=>h});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("el-form",{staticClass:"filter-container",attrs:{inline:"","label-width":"90px",size:"mini"}},[t("el-form-item",{staticClass:"filter-item",attrs:{label:"日期"}},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.searchData.date,callback:function(t){e.$set(e.searchData,"date",t)},expression:"searchData.date"}})],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"团队",prop:"teamId"}},[t("UserTreeSelector",{ref:"userTreeSelector",attrs:{popover:"",selectTeam:"",singleSelect:"",confirmOnSelect:"",visible:e.showUserSelector,selectedValue:e.selectedValue},on:{"update:visible":function(t){e.showUserSelector=t},confirm:e.onTeamUserSelected}},[t("template",{slot:"reference"},[t("el-input",{staticClass:"mr10",staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:"请选择团队",clearable:""},on:{clear:e.clearSelectedUser},model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}})],1)],2)],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:""}},[t("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.fetchData}},[e._v("查询 ")]),t("el-button",{staticClass:"filter-item",on:{click:e.handleReset}},[e._v("重置")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.teamList,"element-loading-text":"拼命计算中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",stripe:"",border:"",size:"small"}},[t("el-table-column",{attrs:{fixed:"",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return["--"==a.row.deptId?t("span",[e._v("团队汇总")]):t("span",[e._v(e._s(a.row.deptName))])]}}])},[t("template",{slot:"header"},[t("span",[e._v("团队 \\ 节目")])])],2),e._l(e.chapterItemList,function(a,s){return t("el-table-column",{key:s,attrs:{align:"center"}},[t("template",{slot:"header"},[t("div",[t("div",[e._v(e._s(a.name))]),t("div",{staticStyle:{"font-size":"8px","line-height":"10px"}},[e._v(" "+e._s(a.startTime.replace(/\:[\d]+$/i,""))+"-"+e._s(a.endTime.replace(/\:[\d]+$/i,""))+" ")])])]),t("el-table-column",{attrs:{align:"center",width:"60"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(e.getData("peakReportVo",s.row.deptId,a.startTime.replace(/\:[\d]+$/i,"")+"-"+a.endTime.replace(/\:[\d]+$/i,""))))])]}}],null,!0)},[t("template",{slot:"header"},[t("div",[e._v("峰值")])])],2),t("el-table-column",{attrs:{align:"center",width:"60"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(e.getData("ipReportVo",s.row.deptId,a.startTime.replace(/\:[\d]+$/i,"")+"-"+a.endTime.replace(/\:[\d]+$/i,""))))])]}}],null,!0)},[t("template",{slot:"header"},[t("div",[e._v("人数")])])],2)],2)})],2)],1)},i=[],r=a(79187),l=a(96208),o=a(95353);const n={name:"Course",components:{UserTreeSelector:r.A},data(){return{selectedValue:void 0,showUserSelector:!1,loading:!1,opts:{roomList:[]},chapterItemList:[],teamList:[],peakAndIpMap:[],searchData:{date:"",roomId:void 0,deptId:void 0,userId:void 0}}},computed:{...(0,o.L8)(["getUserInfo","getLiveRoomInfo"])},created(){function e(){const e=new Date,t=e.getFullYear();let a=e.getMonth()+1,s=e.getDate();return a=a<10?"0"+a:a,s=s<10?"0"+s:s,`${t}-${a}-${s}`}let t=this.$route.query.date;this.searchData.date=t||e();let a=this.$route.query.roomId;a&&(this.searchData.roomId=a);let s=this.$route.query.deptId;s&&(this.searchData.deptId=s);let i=this.$route.query.userId;i&&(this.searchData.userId=i)},mounted(){this.searchData.roomId=this.getLiveRoomInfo.id,2!=this.getUserInfo.type||this.getUserInfo.actForUser?this.getUserInfo.actForUser&&2==this.getUserInfo.actForUser.type&&(this.searchData.parentId=this.getUserInfo.actForUser.userId):this.searchData.parentId=this.getUserInfo.userId,this.getTeams()},methods:{clearSelectedUser(){this.selectedValue=void 0,this.searchData.userId=void 0,this.searchData.deptId=void 0,this.$refs.userTreeSelector&&this.$refs.userTreeSelector.clearSelected&&this.$refs.userTreeSelector.clearSelected()},onTeamUserSelected(e){e?e.selected&&(e.selected.__isUser?(this.searchData.userId=e.selected.userId,this.selectedValue=e.selected.userName,this.searchData.deptId=e.selected.deptId):(this.searchData.deptId=e.selected.deptId,this.selectedValue=e.selected.deptName,this.searchData.userId=void 0)):this.selectedValue=void 0,this.showUserSelector=!1},getTeams(){let e={pageNumber:1,pageSize:500};this.searchData.deptId&&(e.deptId=this.searchData.deptId),e.deptId||e.userId||!this.getUserInfo.actForUser||2==this.getUserInfo.actForUser.type&&(e["userId"]=this.getUserInfo.actForUser.userId),this.teamList.splice(0,this.teamList.length),(0,l.cf)(e).then(e=>{"200"!==e.code&&"201"!==e.code||(this.teamList.splice(0,0,...e.data.records),this.teamList.splice(0,0,{deptId:"--"}),this.getChapterItemList())})},getChapterItemList(){if(!this.searchData.roomId||!this.searchData.date)return void this.$msgbox("必须选择直播间并指定日期");let e={date:this.searchData.date+" 00:00:00",roomId:this.searchData.roomId},t=this;t.chapterItemList.splice(0,t.chapterItemList.length),(0,l.oB)(e).then(e=>{200!=e.code&&201!=e.code||(t.chapterItemList.splice(0,0,...e.data),t.getReportData())})},handleReset(){this.searchData={date:"",roomId:"",team:{}},this.resetLabels()},fetchData(){this.getTeams()},getReportData(){if(!this.searchData.roomId||!this.searchData.date)return void this.$msgbox("必须选择直播间并指定日期");let e=this,t={date:e.searchData.date+" 00:00:00",roomId:e.searchData.roomId};this.searchData.deptId&&(t.deptId=this.searchData.deptId),this.searchData.userId&&(t.userId=this.searchData.userId),t.deptId||t.userId||!this.getUserInfo.actForUser||2==this.getUserInfo.actForUser.type&&(t["userId"]=this.getUserInfo.actForUser.userId),e.loading=!0,(0,l.gw)(t).then(e=>{self.listLoading=!1,"200"!==e.code&&"201"!==e.code||(this.peakAndIpMap=e.data)}).finally(()=>{e.loading=!1})},getData(e,t,a){return this.peakAndIpMap[e]&&this.peakAndIpMap[e][t+"-"+a]&&this.peakAndIpMap[e][t+"-"+a]||0}}},d=n;var c=a(81656),u=(0,c.A)(d,s,i,!1,null,null,null);const h=u.exports},30085:(e,t,a)=>{"use strict";a.d(t,{A:()=>_});var s=function(){var e=this,t=e._self._c;return e.getUserInfo?t("div",{staticClass:"header-container",style:e.getLiveRoomStyle.headerStyle},[t("div",{staticClass:"header-container-inner-left"},[t("div",{staticClass:"header-container-inner-logo"},[t("img",{attrs:{src:e.getLiveRoomTheme.mainPageLogo}}),t("div",{staticClass:"title",style:e.getLiveRoomStyle.titleStyle},[e._v(e._s(e.getLiveRoomInfo.name))])]),t("div",{staticClass:"header-container-inner-nav"},[t("a",{staticClass:"header-container-inner-nav-item",attrs:{href:e.downloadUrl,download:e.getLiveRoomInfo.name+".url"}},[e._v("保存到桌面")]),e._l(e.getLiveRoomTheme.liveNavBarList,function(a,s){return t("div",{key:"hd_lnk_indx_"+s,staticClass:"header-container-inner-nav-item",on:{click:function(t){return e.openLink(a)}}},[e._v(e._s(a.name))])}),e.getLiveRoomInfo&&e.getLiveRoomInfo.extValue&&e.getLiveRoomInfo.extValue.enablePlayback?t("div",{staticClass:"header-container-inner-nav-item",on:{click:e.openPlayback}},[e._v("回放")]):e._e()],2)]),t("div",{staticClass:"header-container-inner-right"},[e.hasReportPromise()?t("el-dropdown",{staticClass:"header-container-inner-info-item",on:{command:e.rightAction}},[t("span",{staticClass:"el-dropdown-link"},[e._v("数据统计"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"online"}},[e._v("在线用户统计")]),t("el-dropdown-item",{attrs:{command:"onlineTime"}},[e._v("观看时长统计")]),t("el-dropdown-item",{attrs:{command:"hours"}},[e._v("小时峰值统计")]),t("el-dropdown-item",{attrs:{command:"course"}},[e._v("课程访客统计")])],1)],1):e._e(),e.getLiveRoomInfo.extValue&&e.getLiveRoomInfo.extValue.enableUserPoints?t("div",{staticClass:"header-container-inner-info-item",on:{click:e.showMyPoints}},[t("svg-icon",{attrs:{"icon-class":"积分"}}),e._v(" 我的积分 ")],1):e._e(),t("div",{staticClass:"header-container-inner-info-item btn",on:{click:e.signup}},[e._v("签到")]),e.showMultiRoom()?t("div",{staticClass:"header-container-inner-info-item btn",on:{click:e.openMultiRoomMsg}},[e._v("多直播间互动")]):e._e(),e.getUserInfo&&e.getUserInfo.levelAvatar?t("LevelIcon",{staticClass:"user-avatar",attrs:{levelAvatar:e.getUserInfo.levelAvatar}}):e._e(),t("el-dropdown",{staticClass:"header-container-inner-info-item",on:{command:e.accountAction}},[t("span",{staticClass:"el-dropdown-link"},[e._v(e._s(e.getUserInfo.nickName)),e.showDropdown()?t("i",{staticClass:"el-icon-arrow-down el-icon--right"}):e._e()]),e.showDropdown()?t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[!e.isGuest&&e.getLiveRoomStyle.headerBarItem&&e.getLiveRoomStyle.headerBarItem.showChangePassword?t("el-dropdown-item",{attrs:{command:"changePasswd"}},[e._v("修改密码")]):e._e(),e.getLiveRoomStyle.headerBarItem&&e.getLiveRoomStyle.headerBarItem.showChangeNickname?t("el-dropdown-item",{attrs:{command:"changeNickname"}},[e._v("修改昵称")]):e._e(),e.isGuest?t("el-dropdown-item",{attrs:{command:"showLoginPanel"}},[e._v("账号登录")]):e._e()],1):e._e()],1),e.isGuest||e.multiRoomFlag?e._e():t("div",{staticClass:"header-container-inner-info-item",on:{click:function(t){return e.logout()}}},[e._v("退出")])],1)]):e._e()},i=[],r=a(95353),l=a(42692),o=a(60460),n=a(30554),d=a(98374),c=a(51181),u=a(2719),h=a(29699),m=a(39469),p=a(36150),g=a(76013),f=a(31428);const v={name:"Header",components:{ChangePassword:o.A,ChangeNickName:n.A,LevelIcon:l.A},props:{user:{type:Object},multiRoomFlag:{type:Boolean,default:!1}},computed:{...(0,r.L8)(["getLoginInfo","getLiveRoomInfo","getUserInfo","isGuest","getToken","getLiveRoomStyle","getLiveRoomTheme","getClientInfo","isMulti"]),downloadUrl(){return`data:text/plain;charset=utf-8,%5B%7B000214A0-0000-0000-C000-000000000046%7D%5D%0AProp3=19,11%0A%5BInternetShortcut%5D%0AIDList=%0AURL=${window.location.origin}/%0AIconFile=${window.location.origin}/favicon.ico%0AIconIndex=1`}},data(){return{myComponent:null}},methods:{openPlayback(){let e={title:"回放列表",component:g.A};this.openLink(e)},showDropdown(){return this.isGuest||!this.isGuest&&this.getLiveRoomStyle.headerBarItem&&this.getLiveRoomStyle.headerBarItem.showChangePassword||this.getLiveRoomStyle.headerBarItem&&this.getLiveRoomStyle.headerBarItem.showChangeNickname},hasReportPromise(){return!!(this.getUserInfo&&[2,3,4].indexOf(this.getUserInfo.type)>=0||this.getUserInfo&&this.getUserInfo.actForUser&&[2,3,4].indexOf(this.getUserInfo.actForUser.type)>=0)},rightAction(e){let t;switch(e){case"online":this.myComponent=d.A,t={title:"在线用户统计",component:this.myComponent},this.openLink(t);break;case"onlineTime":this.myComponent=c.A,t={title:"观看时长统计",component:this.myComponent},this.openLink(t);break;case"course":this.myComponent=h.A,t={title:"课程访客统计",component:this.myComponent},this.openLink(t);break;case"hours":this.myComponent=u.A,t={title:"小时访客统计",component:this.myComponent},this.openLink(t);break}},signup(){let e=this;this.BUS.showDialog({width:"600px",height:"600px"},()=>{e.$modal.show("dialog",{title:"签到",component:m.A,props:{},containerStyle:{display:"flex",flexDirection:"row",justifyContent:"center",overflow:"auto",padding:"0px"},bodyStyle:{display:"block",padding:"0px"},on:{confirm:e=>{},cancel:e.onCloseDialog}})})},showMyPoints(){const e={title:"我的积分",width:"600px",bodyStyle:{padding:"20px"},component:p.A};this.openLink(e)},showMultiRoom(){return!(this.multiRoomFlag||!this.getUserInfo||this.isMulti||3!=this.getUserInfo.type&&4!=this.getUserInfo.type||this.getUserInfo.userDeptList&&0!=this.getUserInfo.userDeptList.length||!this.getLiveRoomInfo||!this.getLiveRoomInfo.multiRooms||!this.getLiveRoomInfo.multiRooms.length)},openMultiRoomMsg(){let e=this.$router.resolve({path:"/multiroom"}).href+"?multiroom=true";setTimeout(()=>{window.open(e,"_blank")},300)},async logout(e){e?(this.$store.commit("setReLogin",!0),this.$store.dispatch("LogOut").then(()=>{location.href="/index"})):this.$confirm("确定注销并退出系统吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$store.commit("setReLogin",!0),(0,f.rj)(),this.$store.dispatch("LogOut").then(()=>{location.href="/index"})}).catch(()=>{})},openLink(e){this.BUS.openLink(e)},accountAction(e){switch(e){case"changePasswd":this.changePasswd();break;case"changeNickname":this.changeNickname();break;case"showLoginPanel":this.showLoginPanel();break}},changePasswd(){let e=this;this.BUS.showDialog({width:"400px",height:"320px"},()=>{e.$modal.show("dialog",{title:"修改密码",component:o.A,props:{},containerStyle:{display:"flex",flexDirection:"row",justifyContent:"center",overflow:"auto"},bodyStyle:{display:"block"},on:{confirm:e.onCloseDialog,cancel:e.onCloseDialog}})})},changeNickname(){let e=this;this.BUS.showDialog({width:"300px",height:"220px"},()=>{e.$modal.show("dialog",{title:"修改昵称",component:n.A,props:{},containerStyle:{display:"flex",flexDirection:"row",justifyContent:"center",overflow:"auto"},bodyStyle:{display:"block"},on:{confirm:e.onCloseDialog,cancel:e.onCloseDialog}})})},showLoginPanel(){this.$store.commit("setReLogin",!0),this.logout(!0)},onCloseDialog(e){this.$modal.hide("dialog")}}},y=v;var b=a(81656),w=(0,b.A)(y,s,i,!1,null,"0c89df46",null);const _=w.exports},30554:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var s=function(){var e=this,t=e._self._c;return t("el-form",{ref:"changeNickNameForm",staticClass:"change-passwd-form",attrs:{size:"small","label-position":"top","label-width":"70px",model:e.changeNickNameForm}},[t("el-form-item",{attrs:{label:"昵称"}},[t("el-input",{attrs:{clearable:"",placeholder:"输入新的昵称"},model:{value:e.changeNickNameForm.nickName,callback:function(t){e.$set(e.changeNickNameForm,"nickName",t)},expression:"changeNickNameForm.nickName"}})],1),t("el-form-item",{staticClass:"botton-bar"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit()}}},[e._v("确定")]),t("el-button",{on:{click:function(t){return e.onCancel()}}},[e._v("取消")])],1)],1)},i=[],r=a(95353),l=a(89613);const o={name:"ChangeNickName",data(){return{changeNickNameForm:{userId:null,nickName:null}}},computed:{...(0,r.L8)(["getUserInfo"])},mounted(){this.changeNickNameForm.userId=this.getUserInfo.userId,this.changeNickNameForm.nickName=this.getUserInfo.nickName},methods:{onSubmit(){this.changeNickNameForm.nickName?this.changeNickNameForm.nickName&&this.changeNickNameForm.nickName!=this.getUserInfo.nickName?(0,l.T)(this.changeNickNameForm).then(e=>{this.getUserInfo.nickName=this.changeNickNameForm.nickName,this.$message.success("成功修改昵称"),this.$emit("confirm",{state:"ok"})}).catch(e=>{this.$message.error("修改昵称失败")}):this.changeNickNameForm.nickName&&this.changeNickNameForm.nickName==this.getUserInfo.nickName&&this.$emit("confirm",{state:"ok"}):this.$message("昵称不能为空")},onCancel(){this.$emit("cancel",{state:"cancel"})}}},n=o;var d=a(81656),c=(0,d.A)(n,s,i,!1,null,"1a921af4",null);const u=c.exports},35358:(e,t,a)=>{var s={"./af":25177,"./af.js":25177,"./ar":61509,"./ar-dz":41488,"./ar-dz.js":41488,"./ar-kw":58676,"./ar-kw.js":58676,"./ar-ly":42353,"./ar-ly.js":42353,"./ar-ma":24496,"./ar-ma.js":24496,"./ar-ps":6947,"./ar-ps.js":6947,"./ar-sa":82682,"./ar-sa.js":82682,"./ar-tn":89756,"./ar-tn.js":89756,"./ar.js":61509,"./az":95533,"./az.js":95533,"./be":28959,"./be.js":28959,"./bg":47777,"./bg.js":47777,"./bm":54903,"./bm.js":54903,"./bn":61290,"./bn-bd":17357,"./bn-bd.js":17357,"./bn.js":61290,"./bo":31545,"./bo.js":31545,"./br":11470,"./br.js":11470,"./bs":44429,"./bs.js":44429,"./ca":7306,"./ca.js":7306,"./cs":56464,"./cs.js":56464,"./cv":73635,"./cv.js":73635,"./cy":64226,"./cy.js":64226,"./da":93601,"./da.js":93601,"./de":77853,"./de-at":26111,"./de-at.js":26111,"./de-ch":54697,"./de-ch.js":54697,"./de.js":77853,"./dv":60708,"./dv.js":60708,"./el":54691,"./el.js":54691,"./en-au":53872,"./en-au.js":53872,"./en-ca":28298,"./en-ca.js":28298,"./en-gb":56195,"./en-gb.js":56195,"./en-ie":66584,"./en-ie.js":66584,"./en-il":65543,"./en-il.js":65543,"./en-in":9033,"./en-in.js":9033,"./en-nz":79402,"./en-nz.js":79402,"./en-sg":43004,"./en-sg.js":43004,"./eo":32934,"./eo.js":32934,"./es":97650,"./es-do":20838,"./es-do.js":20838,"./es-mx":17730,"./es-mx.js":17730,"./es-us":56575,"./es-us.js":56575,"./es.js":97650,"./et":3035,"./et.js":3035,"./eu":3508,"./eu.js":3508,"./fa":119,"./fa.js":119,"./fi":90527,"./fi.js":90527,"./fil":95995,"./fil.js":95995,"./fo":52477,"./fo.js":52477,"./fr":85498,"./fr-ca":26435,"./fr-ca.js":26435,"./fr-ch":37892,"./fr-ch.js":37892,"./fr.js":85498,"./fy":37071,"./fy.js":37071,"./ga":41734,"./ga.js":41734,"./gd":70217,"./gd.js":70217,"./gl":77329,"./gl.js":77329,"./gom-deva":32124,"./gom-deva.js":32124,"./gom-latn":93383,"./gom-latn.js":93383,"./gu":95050,"./gu.js":95050,"./he":11713,"./he.js":11713,"./hi":43861,"./hi.js":43861,"./hr":26308,"./hr.js":26308,"./hu":90609,"./hu.js":90609,"./hy-am":17160,"./hy-am.js":17160,"./id":74063,"./id.js":74063,"./is":89374,"./is.js":89374,"./it":88383,"./it-ch":21827,"./it-ch.js":21827,"./it.js":88383,"./ja":23827,"./ja.js":23827,"./jv":89722,"./jv.js":89722,"./ka":41794,"./ka.js":41794,"./kk":27088,"./kk.js":27088,"./km":96870,"./km.js":96870,"./kn":84451,"./kn.js":84451,"./ko":63164,"./ko.js":63164,"./ku":98174,"./ku-kmr":6181,"./ku-kmr.js":6181,"./ku.js":98174,"./ky":78474,"./ky.js":78474,"./lb":79680,"./lb.js":79680,"./lo":15867,"./lo.js":15867,"./lt":45766,"./lt.js":45766,"./lv":69532,"./lv.js":69532,"./me":58076,"./me.js":58076,"./mi":41848,"./mi.js":41848,"./mk":30306,"./mk.js":30306,"./ml":73739,"./ml.js":73739,"./mn":99053,"./mn.js":99053,"./mr":86169,"./mr.js":86169,"./ms":73386,"./ms-my":92297,"./ms-my.js":92297,"./ms.js":73386,"./mt":77075,"./mt.js":77075,"./my":72264,"./my.js":72264,"./nb":22274,"./nb.js":22274,"./ne":8235,"./ne.js":8235,"./nl":92572,"./nl-be":43784,"./nl-be.js":43784,"./nl.js":92572,"./nn":54566,"./nn.js":54566,"./oc-lnc":69330,"./oc-lnc.js":69330,"./pa-in":29849,"./pa-in.js":29849,"./pl":94418,"./pl.js":94418,"./pt":79834,"./pt-br":48303,"./pt-br.js":48303,"./pt.js":79834,"./ro":24457,"./ro.js":24457,"./ru":82271,"./ru.js":82271,"./sd":1221,"./sd.js":1221,"./se":33478,"./se.js":33478,"./si":17538,"./si.js":17538,"./sk":5784,"./sk.js":5784,"./sl":46637,"./sl.js":46637,"./sq":86794,"./sq.js":86794,"./sr":45719,"./sr-cyrl":3322,"./sr-cyrl.js":3322,"./sr.js":45719,"./ss":56e3,"./ss.js":56e3,"./sv":41011,"./sv.js":41011,"./sw":40748,"./sw.js":40748,"./ta":11025,"./ta.js":11025,"./te":11885,"./te.js":11885,"./tet":28861,"./tet.js":28861,"./tg":86571,"./tg.js":86571,"./th":55802,"./th.js":55802,"./tk":59527,"./tk.js":59527,"./tl-ph":29231,"./tl-ph.js":29231,"./tlh":8671,"./tlh.js":8671,"./tr":85096,"./tr.js":85096,"./tzl":79846,"./tzl.js":79846,"./tzm":81765,"./tzm-latn":97711,"./tzm-latn.js":97711,"./tzm.js":81765,"./ug-cn":48414,"./ug-cn.js":48414,"./uk":16618,"./uk.js":16618,"./ur":57777,"./ur.js":57777,"./uz":57609,"./uz-latn":72475,"./uz-latn.js":72475,"./uz.js":57609,"./vi":21135,"./vi.js":21135,"./x-pseudo":64051,"./x-pseudo.js":64051,"./yo":82218,"./yo.js":82218,"./zh-cn":52648,"./zh-cn.js":52648,"./zh-hk":1632,"./zh-hk.js":1632,"./zh-mo":31541,"./zh-mo.js":31541,"./zh-tw":50304,"./zh-tw.js":50304};function i(e){var t=r(e);return a(t)}function r(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=r,e.exports=i,i.id=35358},36150:(e,t,a)=>{"use strict";a.d(t,{A:()=>ie});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container",class:e.isMobile?"mobile":""},[t("div",{staticClass:"mypoints-top-panel",class:e.isMobile?"mobile":""},[t("div",{staticClass:"mypoints-total-points-panel"},[t("div",{staticClass:"mypoints-total-points-left-panel"},[t("div",{staticClass:"mypoints-total-points-left-panel-row"},[t("div",{staticClass:"mypoints-total-points-item"},[t("div",[e._v("可用积分：")]),t("div",[e._v(e._s(e.summary.remainderPoints||0))])]),t("div",{staticClass:"mypoints-total-points-item"},[t("div",[e._v("累计积分：")]),t("div",[e._v(e._s(e.summary.totalPoints||0))])])]),t("div",{staticClass:"mypoints-total-points-left-panel-row"},[t("div",{staticClass:"mypoints-total-points-item"},[t("div",[e._v("已兑换:")]),t("div",[e._v(e._s(e.summary.totalExchangePoints||0))])]),t("div",{staticClass:"mypoints-total-points-item"},[t("div",[e._v("申请中:")]),t("div",[e._v(e._s(e.summary.totalApplyPoints||0))])])])]),t("div",{staticClass:"mypoints-top-panel-btn-panel",on:{click:e.showMyPoints}},[t("svg-icon",{attrs:{"icon-class":"积分兑换"}}),t("span",[e._v("积分兑换")])],1)]),t("div",{staticClass:"mypoints-exchange-history-panel"},[t("div",{staticClass:"item",class:"firstItem"==e.activeItem?"active":"",on:{click:function(t){e.activeItem="firstItem"}}},[t("div",[e._v("积分获取清单")])]),t("div",{staticClass:"item",class:"thirdItem"==e.activeItem?"active":"",on:{click:function(t){e.activeItem="thirdItem"}}},[t("div",[e._v("积分兑换清单")])])])]),"firstItem"!=e.activeItem||e.showApply?e._e():t("my-point-detail-list",{class:e.isMobile?"mypoints-bottom-panel":""}),"thirdItem"!=e.activeItem||e.showApply?e._e():t("my-point-exchange-list",{class:e.isMobile?"mypoints-bottom-panel":""}),e.showApply?t("my-point-exchange-apply",{attrs:{summary:e.summary},on:{close:e.closeApplyDialog}}):e._e()],1)},i=[],r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mypoints-detail-container",class:e.isMobile?"mobile":""},[t("el-timeline",{attrs:{reverse:!1}},e._l(e.userDetails,function(a,s){return t("el-timeline-item",{key:s,attrs:{timestamp:a.createdTime,size:"large",type:"primary",icon:"el-icon-timer"}},[t("div",[t("h4",[e._v(e._s(e.getLabel("pointTypes",a.typeCode).label))]),t("p",[e._v(e._s(e.getPointDetailRemark(a)))])])])}),1),t("div",{staticClass:"mypoints-detail-pagination-container"},[t("el-pagination",{attrs:{"hide-on-single-page":!0,"current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,total:e.queryParams.total,layout:"prev, pager, next","pager-count":5},on:{"update:currentPage":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:current-page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:pageSize":function(t){return e.$set(e.queryParams,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParams,"pageSize",t)},"current-change":e.getList}})],1)],1)},l=[],o=a(95353),n=a(56972),d=a(50101),c=a(52112);function u(e){return(0,d.A)({url:"/market/mktUserPointsDetail/list",method:"post",data:(0,c.Cn)(e)})}const h={name:"MyPointDetailList",data(){return{getLabel:n.p9,getPointDetailRemark:n.WZ,queryParams:{total:0,pageNum:1,pageSize:10,userId:null,roomId:null},userDetails:[],activeItem:"firstItem"}},computed:{...(0,o.L8)(["getUserInfo","getLiveRoomInfo","isMobile"])},created(){this.queryParams.userId=this.getUserInfo.userId,this.queryParams.roomId=this.getLiveRoomInfo.id,this.getList()},methods:{getList(){u(this.queryParams).then(e=>{this.userDetails=e.data.records,this.queryParams.total=Number(e.data.total)})}}},m=h;var p=a(81656),g=(0,p.A)(m,r,l,!1,null,"1f8acb8e",null);const f=g.exports;var v=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mypoints-exchange-container",class:e.isMobile?"mobile":""},[t("el-timeline",{attrs:{reverse:!1}},e._l(e.exchangeList,function(a,s){return t("el-timeline-item",{key:s,attrs:{timestamp:0===Number(a.status)?a.createdTime:a.updatedTime,size:"large",type:"primary",color:e.getTimelineColor(a),icon:e.getTimelineIcon(a)}},[t("div",[t("h4",[e._v(e._s(0==a.status?"申请":1==a.status?"成功用":-1==a.status?"申请":"")+e._s(a.points)+"积分兑换"+e._s(e.sumProdCount(a)||0)+"件商品"+e._s(-1==a.status?"被驳回":""))]),t("p",[e._v(e._s(e.getPointExchangeRemark(a)))]),a.reviewComments&&0!=a.status?t("p",[e._v("审核意见："+e._s(a.reviewComments))]):e._e(),t("p",[e._v("单号："+e._s(a.id))])])])}),1),t("div",{staticClass:"mypoints-exchange-pagination-container"},[t("el-pagination",{attrs:{"hide-on-single-page":!0,"current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,total:e.queryParams.total,layout:"prev, pager, next","pager-count":5},on:{"update:currentPage":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:current-page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:pageSize":function(t){return e.$set(e.queryParams,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParams,"pageSize",t)},"current-change":e.getList}})],1)],1)},y=[];a(18111),a(7588),a(61701);function b(e){return(0,d.A)({url:"/market/mktUserExchange/list",method:"post",data:(0,c.Cn)(e)})}function w(e){return(0,d.A)({url:"/market/mktUserExchange/listSum",method:"post",data:e})}function _(e){return(0,d.A)({url:"/market/mktUserExchange/create",method:"post",data:e})}const I={name:"MyPointExchangeList",data(){return{getLabel:n.p9,queryParams:{total:0,pageNum:1,pageSize:10,userId:null,roomId:null},exchangeList:[],activeItem:"firstItem"}},computed:{...(0,o.L8)(["getUserInfo","getLiveRoomInfo","isMobile"])},created(){this.queryParams.userId=this.getUserInfo.userId,this.queryParams.roomId=this.getLiveRoomInfo.id,this.getList()},methods:{getPointExchangeRemark(e){return`申请${e.points}积分兑换${Number(this.sumProdCount(e)||0)}件商品, 申请兑换的商品:[${e.prods.map(e=>e.prodName+" x "+e.count).join(", ")}]`},sumProdCount(e){let t=0;return e.prods.forEach(e=>t+=e.count),t},getTimelineIcon(e){switch(e.status){case-1:return"el-icon-warning";case 0:return"el-icon-s-claim";case 1:return"el-icon-success";default:return"el-icon-info"}},getTimelineColor(e){switch(e.status){case-1:return"#d26161";case 0:return"#4b9dd9";case 1:return"#50d94b";default:return"#d3d3d3"}},getList(){b(this.queryParams).then(e=>{const t=e.data.records;for(let a=0;a<t.length;a++){let e=t[a];if(0!==e.status){const s=(0,c.Go)(e);s.status=0,t.splice(a+1,0,s),a++}}this.exchangeList=t,this.queryParams.total=Number(e.data.total)})}}},k=I;var C=(0,p.A)(k,v,y,!1,null,"5455509e",null);const x=C.exports;var S=a(62978),D=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mypoints-exchange-apply-container",class:e.isMobile?"mobile":""},[t("div",{staticClass:"top-close-bar"},[t("div",{staticClass:"top-close-bar-title"},[e._v("积分兑换")]),t("div",{staticClass:"top-close-bar-btn",on:{click:e.handleClose}},[t("i",{staticClass:"el-icon-close"})])]),t("div",{staticClass:"mypoints-exchange-apply-panel",class:e.isMobile?"mobile":""},e._l(e.productList,function(a){return t("div",{key:"prod_"+a.id,staticClass:"prod-item-container"},[t("div",{staticClass:"prod-item-img-container"},[t("el-carousel",{staticClass:"prod-item-img-carousel",attrs:{width:"100%",height:"100%",autoplay:!1}},[t("el-carousel-item",[t("img",{staticClass:"prod-item-img",attrs:{src:a.pic}})]),e._l(a.imgs?a.imgs.split(","):[],function(e){return t("el-carousel-item",{key:e},[t("img",{staticClass:"prod-item-img",attrs:{src:e}})])})],2)],1),t("div",{staticClass:"prod-item-title"},[e._v(e._s(a.prodName))]),t("div",{staticClass:"prod-item-comment"},[e._v(e._s(a.brief))]),t("div",{staticClass:"prod-item-exchange-panel"},[t("span",{staticClass:"prod-require-point"},[e._v("所需积分："+e._s(a.points))]),t("el-input-number",{staticClass:"prod-exchange-count",attrs:{size:"mini",min:0,max:e.countStepMaxMap[a.id],step:1,"controls-position":"right"},on:{change:function(t){return e.calcPoints(a)}},model:{value:e.exchangeProdMap[a.id],callback:function(t){e.$set(e.exchangeProdMap,a.id,t)},expression:"exchangeProdMap[prod.id]"}})],1),t("div",{staticClass:"prod-item-detail-bar",on:{click:function(t){return e.showProdDetail(a)}}},[t("div",{staticClass:"prod-item-detail-btn"},[e._v("查看详情")])])])}),0),t("div",{staticClass:"dialog-footer"},[t("div",{staticClass:"dialog-footer-infobar"},[e.totalPoints?t("div",[e._v(e._s(e.totalPoints)+"/"+e._s(e.summary.remainderPoints||0))]):e._e()]),t("div",{staticClass:"dialog-footer-toolbar"},[e.totalPoints?t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showExtInfo=!0}}},[e._v("兑 换")]):e._e(),t("el-button",{on:{click:e.handleClose}},[e._v("取 消")])],1)]),e.showExtInfo?t("div",{staticClass:"exchange-extinfo-container-mask"},[t("div",{staticClass:"exchange-extinfo-container"},[t("el-form",{ref:"form",staticClass:"exchange-extinfo-form",attrs:{model:e.form,rules:e.rules}},[t("div",{staticClass:"exchange-extinfo-notice"},[e._v(" 请留下联系方式方便核对兑换人信息 ")]),t("el-form-item",{attrs:{label:"联系人",prop:"receiver"}},[t("el-input",{attrs:{placeholder:"请输入联系人"},model:{value:e.form.receiver,callback:function(t){e.$set(e.form,"receiver",t)},expression:"form.receiver"}})],1),t("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[t("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e.shipping.includes(1)?t("div",{staticClass:"exchange-extinfo-notice"},[e._v(" 包含快递商品，请留下详细的收件地址 ")]):e._e(),e.shipping.includes(1)?t("UserAddressList",{on:{updateAddress:e.updateAddress}}):e._e(),e.shipping.includes(1)?t("el-form-item",{attrs:{label:"省市区/县"}},[e.showProvince?t("AreaSelect",{staticClass:"w-full",attrs:{data:e.form}}):e._e()],1):e._e(),e.shipping.includes(1)?t("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[t("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1):e._e(),t("el-form-item",{attrs:{label:"备注",prop:"applyComments"}},[t("el-input",{attrs:{type:"textarea",rows:3,maxlength:60,placeholder:"请输入备注"},model:{value:e.form.applyComments,callback:function(t){e.$set(e.form,"applyComments",t)},expression:"form.applyComments"}})],1),e.shipping.includes(2)?t("div",{staticClass:"exchange-extinfo-notice"},[e._v(" 包含自取商品，自取商品取货地址 "),e._l(e.businessAddressList,function(a,s){return t("div",{key:"biz_addr_"+s},[e._v(" "+e._s(e.businessAddressList.length>1?"["+(s+1)+"].":"")+e._s(a.province)+e._s(a.city)+e._s(a.area)+e._s(a.address)+e._s(a.phone?",联系电话:"+a.phone:"")+" ")])})],2):e._e()],1),t("div",{staticClass:"dialog-footer-toolbar"},[e.totalPoints?t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]):e._e(),t("el-button",{on:{click:function(t){e.showExtInfo=!1}}},[e._v("取 消")])],1)],1)]):e._e(),e.showDetail?t("MyPointProdutDetail",{attrs:{prod:e.curProd},on:{close:function(t){e.showDetail=!1}}}):e._e()],1)},P=[];a(44114),a(22489);function L(e){return(0,d.A)({url:"/market/mktProd/list",method:"post",data:(0,c.Cn)(e)})}var T=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mypoints-prod-detail-container",class:e.isMobile?"mobile":""},[t("div",{staticClass:"top-close-bar"},[t("div",{staticClass:"top-close-bar-title"},[e._v("产品详情")]),t("div",{staticClass:"top-close-bar-btn",on:{click:e.handleClose}},[t("i",{staticClass:"el-icon-close"})])]),t("div",{staticClass:"mypoints-prod-detail-panel ql-container ql-snow"},[t("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(e.prod.content)}})])])},U=[];const N={name:"MyPointProdutDetail",props:{prod:{type:Object,required:!0}},data(){return{}},computed:{...(0,o.L8)(["getUserInfo","getLiveRoomInfo","isMobile"])},methods:{handleClose(){this.$emit("close")}}},F=N;var $=(0,p.A)(F,T,U,!1,null,"deb837e6",null);const M=$.exports;var A=function(){var e=this,t=e._self._c;return t("el-row",{staticClass:"area-select-container"},[t("el-col",{attrs:{span:8}},[t("el-select",{staticClass:"area-select-item",attrs:{clearable:"",placeholder:"请选择省"},on:{change:e.selectProvince},model:{value:e.dataForm.provinceId,callback:function(t){e.$set(e.dataForm,"provinceId",t)},expression:"dataForm.provinceId"}},e._l(e.provinceList,function(e){return t("el-option",{key:e.id,attrs:{label:e.areaName,value:e.id}})}),1)],1),t("el-col",{attrs:{span:8}},[t("el-select",{staticClass:"area-select-item",attrs:{clearable:"",placeholder:"请选择市"},on:{change:e.selectCity},model:{value:e.dataForm.cityId,callback:function(t){e.$set(e.dataForm,"cityId",t)},expression:"dataForm.cityId"}},e._l(e.cityList,function(e){return t("el-option",{key:e.id,attrs:{label:e.areaName,value:e.id}})}),1)],1),t("el-col",{attrs:{span:8}},[t("el-select",{staticClass:"area-select-item",attrs:{clearable:"",placeholder:"请选择区/县"},on:{change:e.selectArea},model:{value:e.dataForm.areaId,callback:function(t){e.$set(e.dataForm,"areaId",t)},expression:"dataForm.areaId"}},e._l(e.areaList,function(e){return t("el-option",{key:e.id,attrs:{label:e.areaName,value:e.id}})}),1)],1)],1)},j=[];function V(e){return(0,d.A)({url:"/base/area/list",method:"post",data:(0,c.Cn)(e)})}const z={name:"AreaSelect",props:{data:{type:Object,required:!0}},data(){return{provinceList:[],cityList:[],areaList:[],dataForm:{provinceId:null,province:null,cityId:null,city:null,areaId:null,area:null}}},created(){this.data.provinceId?Object.assign(this.dataForm,this.data):(this.dataForm.provinceId=null,this.dataForm.province=null,this.dataForm.cityId=null,this.dataForm.city=null,this.dataForm.areaId=null,this.dataForm.area=null),V({parentId:0,pageSize:1e4}).then(({data:e})=>{this.provinceList=e.records}),this.data.provinceId&&V({parentId:this.dataForm.provinceId,pageSize:1e4}).then(({data:e})=>{this.cityList=e.records}),this.data.cityId&&V({parentId:this.dataForm.cityId,pageSize:1e4}).then(({data:e})=>{this.areaList=e.records})},methods:{selectProvince(e){if(!this.dataForm.provinceId)return this.dataForm.province=null,this.dataForm.cityId=null,this.dataForm.city=null,this.dataForm.areaId=null,void(this.dataForm.area=null);for(let t=0;t<this.provinceList.length;t++)if(this.provinceList[t].id===this.dataForm.provinceId){this.dataForm.province=this.provinceList[t].areaName;break}this.dataForm.cityId=null,this.dataForm.city=null,this.dataForm.areaId=null,this.dataForm.area=null,Object.assign(this.data,this.dataForm),V({parentId:this.dataForm.provinceId,pageSize:1e4}).then(({data:e})=>{this.cityList=e.records})},selectCity(e){if(!this.dataForm.cityId)return this.dataForm.city=null,this.dataForm.areaId=null,void(this.dataForm.area=null);for(let t=0;t<this.cityList.length;t++)if(this.cityList[t].id===this.dataForm.cityId){this.dataForm.city=this.cityList[t].areaName;break}this.dataForm.areaId=null,this.dataForm.area=null,Object.assign(this.data,this.dataForm),V({parentId:this.dataForm.cityId,pageSize:1e4}).then(({data:e})=>{this.areaList=e.records})},selectArea(e){if(this.dataForm.areaId){for(let e=0;e<this.areaList.length;e++)if(this.areaList[e].id===this.dataForm.areaId){this.dataForm.area=this.areaList[e].areaName;break}Object.assign(this.data,this.dataForm)}else this.dataForm.area=null}}},R=z;var q=(0,p.A)(R,A,j,!1,null,"0e1b161e",null);const B=q.exports;function H(e){return(0,d.A)({url:"/market/mktBusinessAddress/listFromRoom",method:"post",data:(0,c.Cn)(e)})}function O(e){return(0,d.A)({url:"/market/mktUserAddress/list",method:"post",data:(0,c.Cn)(e)})}var E=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-address-panel"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"addrTable",attrs:{data:e.UserAddressList,"show-header":!1,"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[t("el-table-column",{attrs:{type:"index",width:"18"}}),t("el-table-column",{attrs:{label:"省市区/县详细地址",prop:"province"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.province)+e._s(a.row.city)+e._s(a.row.area)+e._s(a.row.address))])]}}])})],1)],1)},W=[];const Y={name:"UserAddressList",data(){return{loading:!0,ids:[],single:!0,multiple:!0,total:0,UserAddressList:[],templateSelection:"",templateRadio:null,queryParams:{pageNum:1,pageSize:100,userName:null}}},created(){this.getList()},computed:{...(0,o.L8)(["getUserInfo"])},methods:{getList(){this.loading=!0,this.queryParams.userName=this.getUserInfo.userName,O(this.queryParams).then(e=>{this.UserAddressList=e.data.records,this.total=Number(e.total||e.data.total),this.loading=!1})},handleCurrentChange(e){this.$emit("updateAddress",e)}}},G=Y;var K=(0,p.A)(G,E,W,!1,null,"7a245c42",null);const X=K.exports,Q={name:"MyPointExchangeApply",components:{UserAddressList:X,AreaSelect:B,MyPointProdutDetail:M},props:{summary:{type:Object,required:!0}},data(){return{remainderCash:0,exchangeProdMap:{},productList:[],totalPoints:0,countStepMaxMap:{},showExtInfo:!1,form:{userId:null,roomId:null,receiver:null,phone:null,provinceId:null,province:null,cityId:null,city:null,areaId:null,area:null,address:null,applyComments:null,points:0,prods:[]},rules:{},shipping:[],showDetail:!1,curProd:null,businessAddressList:[],userAddressList:[],showProvince:!0}},computed:{...(0,o.L8)(["getUserInfo","getLiveRoomInfo","isMobile"])},created(){this.form.userId=this.getUserInfo.userId,this.form.roomId=this.getLiveRoomInfo.id,this.listProductions(),this.listBusinessAddress()},watch:{"form.points"(e,t){this.changePoints()}},methods:{listBusinessAddress(){H({roomId:this.getLiveRoomInfo.id,type:0,pageSize:1e4}).then(e=>{this.businessAddressList=e.data.records})},listUserAddress(){O({UserName:this.getUserInfo.userName,pageSize:1e4}).then(e=>{this.userAddressList=e.data.records})},updateAddress(e){this.showProvince=!1,Object.assign(this.form,{provinceId:e.provinceId,province:e.province,cityId:e.cityId,city:e.city,areaId:e.areaId,area:e.area,address:e.address}),setTimeout(()=>{this.showProvince=!0},20)},showProdDetail(e){this.curProd=e,this.showDetail=!0},calcPoints(e){let t=0;if(this.summary.remainderPoints){const a=()=>{t=0,this.shipping.splice(0,this.shipping.length);for(let e in this.exchangeProdMap)if(this.exchangeProdMap[e]){const a=this.productList.filter(t=>t.id==e)[0];a&&!this.shipping.includes(Number(a.shipping))&&this.shipping.push(Number(a.shipping)),t+=this.exchangeProdMap[e]*Number(a.points)}};if(a(),t>Number(this.summary.remainderPoints)){do{this.exchangeProdMap[e.id]--,a()}while(t>Number(this.summary.remainderPoints)&&this.exchangeProdMap[e.id]>0);this.totalPoints=t}else this.totalPoints=t}for(let a in this.productList){const e=this.productList[a];if(this.totalPoints+Number(e.points)>Number(this.summary.remainderPoints))this.countStepMaxMap[e.id]=this.exchangeProdMap[e.id];else{let t=Math.floor((Number(this.summary.remainderPoints)-this.totalPoints)/Number(e.points));this.countStepMaxMap[e.id]=this.exchangeProdMap[e.id]+t}}},listProductions(){L().then(e=>{e.data.records.forEach(e=>{this.exchangeProdMap[e.id]=0,this.countStepMaxMap[e.id]=999999}),this.productList=e.data.records})},priceFormat(e){return void 0!==e&&null!==e?"￥"+(0,S.$g)(e):"￥0.0"},calcExchange(e){let t=(Number(this.exchangeRule.cash)/Number(this.exchangeRule.ruleValue)).toFixed(2);return(Number(e||0)*t).toFixed(2)},changePoints(){let e=(Number(this.exchangeRule.cash)/Number(this.exchangeRule.ruleValue)).toFixed(2);this.form.exchange=(this.form.points*e).toFixed(2)},submitForm(){const e=Object.assign({},this.form);e.points=this.totalPoints;for(let t in this.exchangeProdMap)if(this.exchangeProdMap[t]){const a=this.productList.filter(e=>e.id==t)[0];if(a){const s={...a,count:this.exchangeProdMap[t]};s.prodId=s.id,delete s.id,e.prods.push(s)}}_(e).then(e=>{const t={title:"我的积分"};this.BUS.changeDialogParams(t),this.$emit("close")})},handleClose(){const e={title:"我的积分"};this.BUS.changeDialogParams(e),this.$emit("close")}}},Z=Q;var J=(0,p.A)(Z,D,P,!1,null,"322aadc8",null);const ee=J.exports,te={name:"MyPoints",components:{MyPointExchangeApply:ee,MyPointExchangeList:x,MyPointDetailList:f},data(){return{activeItem:"firstItem",userId:null,summary:{},showApply:!1}},computed:{...(0,o.L8)(["getUserInfo","getLiveRoomInfo","isMobile"])},created(){this.listSummary()},methods:{showMyPoints(){if(!this.isMobile){const e={title:"积分兑换申请",hideTitle:!0};this.BUS.changeDialogParams(e)}this.showApply=!0},listSummary(){w({userId:this.getUserInfo.userId}).then(e=>{this.summary=e.data[0]||{}})},priceFormat(e){return void 0!==e&&null!==e?"￥"+(0,S.$g)(e):"￥0.0"},closeApplyDialog(){this.listSummary(),this.showApply=!1}}},ae=te;var se=(0,p.A)(ae,s,i,!1,null,"5d4deb55",null);const ie=se.exports},39469:(e,t,a)=>{"use strict";a.d(t,{A:()=>g});var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"logonBox"},[t("div",{staticClass:"box"},[t("div",{staticClass:"boxRight"},[e.showClose?t("svg-icon",{staticClass:"icon",attrs:{"icon-class":"close"},on:{click:e.onEmit}}):e._e(),t("div",{staticClass:"calendarBox"},[t("div",{staticClass:"head"},[t("div",{staticClass:"head-nav-btn",on:{click:e.prevMonth}},[e._v("<  上月")]),e._v(" "+e._s(e.year)+"年"+e._s(e.month)+"月 "),t("div",{staticClass:"head-nav-btn",on:{click:e.nextMonth}},[e._v("下月  >")])]),t("div",{staticClass:"week"},e._l(e.weekArr,function(a,s){return t("div",{key:s},[e._v(e._s(a))])}),0),e._l(e.dateArr,function(a,s){return t("div",{directives:[{name:"show",rawName:"v-show",value:e.contains(a),expression:"contains(item)"}],key:s,staticClass:"calendar"},e._l(a,function(a,s){return t("div",{key:s,staticClass:"date-item",class:(e.isCheck(a)?"checked ":" ")+(e.date==a&&e.year==e.curYear&&e.month==e.curMonth?"today":"")},[e._v(" "+e._s(e.date==a&&e.year==e.curYear&&e.month==e.curMonth?"今天":a)+" ")])}),0)})],2),t("div",{staticClass:"button",on:{click:e.signUp}},[e._v("签到")]),e.isElmessage?t("div",{staticClass:"elmessage"},[t("span",[e._v(e._s(e.signMsg))])]):e._e()],1)])])},i=[],r=a(85471),l=a(95353),o=a(93756);const n=()=>{const e=(0,r.getCurrentInstance)();if(!e)throw new Error("must be called in setup");return e.proxy.$store};var d=a(40752),c=a(57417);a(10248);const u=(0,r.defineComponent)({name:"SignUp",props:{showClose:{type:Boolean,default:!1}},setup(e,{emit:t}){const a=n(),s=(0,l.L8)(["getUserInfo","getLiveRoomInfo","getClientInfo"]),i=(0,r.computed)(s.getUserInfo.bind({$store:a})).value,u=(0,r.computed)(s.getLiveRoomInfo.bind({$store:a})).value,h=(0,r.computed)(s.getClientInfo.bind({$store:a})).value,m=(0,r.reactive)({weekArr:["日","一","二","三","四","五","六"],today:new Date,curYear:"",curMonth:"",curDate:"",year:"",month:"",day:"",date:"",dateArr:[],isElmessage:!1,signUpList:[],signMsg:"今日签到成功"});(0,r.onMounted)(()=>{m.year=m.today.getFullYear(),m.month=m.today.getMonth()+1,m.day=m.today.getDay(),m.date=m.today.getDate(),m.curYear=m.today.getFullYear(),m.curMonth=m.today.getMonth()+1,m.curDate=m.today.getDate(),y()});const p=()=>{t("cancel",!1)},g=()=>{const e=m.year;return e%4==0&&e%100>0||e%400==0&&e%3200>0},f=()=>{const e=m.month;return 2==e?g()?29:28:e<8?e%2>0?31:30:e%2>0?30:31},v=()=>m.year+"-"+m.month+"-"+m.date,y=()=>{for(var e=f(),t=new Date(m.year,m.month-1,1),a=t.getDay(),s=new Array,r=0,l=0;l<6;l++){s[l]=new Array;for(var n=0;n<7;n++)r++,s[l][n]=r-a>0&&r-a<=e?r-a:""}m.dateArr=s;let d={userId:i.userId,module:3,moduleId:u.id,startTime:(m.year+"").padStart(4,"0")+"-"+(m.month+"").padStart(2,"0")+"-01 00:00:00",endTime:(m.year+"").padStart(4,"0")+"-"+(m.month+"").padStart(2,"0")+"-"+(e+"").padStart(2,"0")+" 23:59:59"};(0,o.G7)(d).then(e=>{200!=e.code&&201!=e.code||(m.signUpList=e.data)})},b=()=>{12==m.month?(m.year++,m.month=1):m.month++,y()},w=()=>{1==m.month?(m.year--,m.month=12):m.month--,y()},_=e=>""!=e[0]||""!=e[1]||""!=e[2]||""!=e[3]||""!=e[4]||""!=e[5]||""!=e[6],I=e=>{const t=`${m.year}-${m.month<10?"0"+m.month:m.month}-${e<10?"0"+e:e}`;for(let a=0;a<m.signUpList.length;a++)if(m.signUpList[a].signOnTime.replace(/\s+\d+\:\d+\:\d+$/g,"")==t)return!0;return!1},k=()=>{let e=(0,d.RH)(c.iC.LIVE_MSG,"TEXT","签到成功",i,null,u,h),t=e.data;t.module=3,t.moduleId=t.roomId,t.moduleName=t.roomName,(0,o.Y2)(t).then(e=>{e.data?(m.signMsg="今日签到成功",m.isElmessage=!0,y(),setTimeout(()=>{m.isElmessage=!1},1500)):(m.signMsg="今天已经签过到",m.isElmessage=!0,setTimeout(()=>{m.isElmessage=!1},1500))})};return{...(0,r.toRefs)(m),isCheck:I,contains:_,prevMonth:w,nextMonth:b,getCalendar:y,getCalendarTime:v,getLen:f,isLeap:g,onEmit:p,signUp:k}}}),h=u;var m=a(81656),p=(0,m.A)(h,s,i,!1,null,"58027273",null);const g=p.exports},42692:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"level-icon"},[t("img",{attrs:{src:e.levelAvatar}})])},i=[];const r={name:"LevelIcon",props:{levelAvatar:String},data(){return{}}},l=r;var o=a(81656),n=(0,o.A)(l,s,i,!1,null,"4efea3ce",null);const d=n.exports},51181:(e,t,a)=>{"use strict";a.d(t,{A:()=>f});a(18111),a(61701);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("el-form",{staticClass:"filter-container",attrs:{inline:"","label-width":"90px",size:"mini"}},[t("el-form-item",{attrs:{label:"时间"}},[t("DateTimePicker",{attrs:{size:"mini",layoutModel:"datetime",isRange:!0,showSecond:!1},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}})],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"团队",prop:"teamId"}},[t("UserTreeSelector",{ref:"userTreeSelector",attrs:{popover:"",selectTeam:"",singleSelect:"",confirmOnSelect:"",visible:e.showUserSelector,selectedValue:e.selectedValue},on:{"update:visible":function(t){e.showUserSelector=t},confirm:e.onTeamUserSelected}},[t("template",{slot:"reference"},[t("el-input",{staticClass:"mr10",staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:"请选择团队",clearable:""},on:{clear:e.clearSelectedUser},model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}})],1)],2)],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"等级",prop:"levelId"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择等级"},model:{value:e.map.levelId,callback:function(t){e.$set(e.map,"levelId",t)},expression:"map.levelId"}},e._l(e.opts.levelList,function(e,a){return t("el-option",{key:"ulevel_indx_"+a,attrs:{label:e.name,value:e.id}})}),1)],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"用户名",prop:"userName"}},[t("el-input",{staticClass:"mr10",staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:"请输入用户名",clearable:""},model:{value:e.map.userName,callback:function(t){e.$set(e.map,"userName",t)},expression:"map.userName"}})],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"昵称",prop:"nickName"}},[t("el-input",{staticClass:"mr10",staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:"请输入用户昵称",clearable:""},model:{value:e.map.nickName,callback:function(t){e.$set(e.map,"nickName",t)},expression:"map.nickName"}})],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"用户类型",prop:"groupId"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择用户类型"},model:{value:e.map.type,callback:function(t){e.$set(e.map,"type",t)},expression:"map.type"}},e._l(e.opts.typeList,function(e,a){return t("el-option",{key:"utype_opt_indx_"+a,attrs:{label:e.name,value:e.value}})}),1)],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"观看分钟数",prop:"onlineTime"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择分钟数"},model:{value:e.map.onlineTime,callback:function(t){e.$set(e.map,"onlineTime",t)},expression:"map.onlineTime"}},e._l(e.opts.watchLengthes,function(e,a){return t("el-option",{key:"u_itme_index_"+a,attrs:{label:e.label,value:e.value}})}),1)],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:""}},[t("el-button",{attrs:{type:"primary"},on:{click:e.handleCheck}},[e._v("查询 ")]),t("el-button",{on:{click:e.handleReset}},[e._v("重置")]),t("el-button",{attrs:{type:"success"},on:{click:e.exportFn}},[e._v("导出 ")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,size:"mini","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",border:"",fit:"","highlight-current-row":""}},[t("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50",index:e.getIndex}}),t("el-table-column",{attrs:{label:"账号",prop:"userName",width:"100"}}),t("el-table-column",{attrs:{label:"昵称",prop:"nickName"}}),t("el-table-column",{attrs:{label:"直播间",prop:"roomName",width:"110"}}),t("el-table-column",{attrs:{label:"最早登录时间",prop:"loginTime"}}),t("el-table-column",{attrs:{label:"最后退出时间",prop:"logoutTime"}}),t("el-table-column",{attrs:{label:"观看(分钟)",prop:"onlineTime",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.watchLength(t.row))+" ")]}}])}),t("el-table-column",{attrs:{label:"登录次数",prop:"loginCounts",width:"70"}}),t("el-table-column",{attrs:{label:"用户类型",align:"center",prop:"type",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.userTypes[Number(t.row.type)])+" ")]}}])}),t("el-table-column",{attrs:{label:"等级",prop:"levelName",width:"110"}}),t("el-table-column",{attrs:{label:"上级账号",prop:"parentUserName",width:"100"}}),t("el-table-column",{attrs:{label:"所属团队",prop:"deptName"}}),t("el-table-column",{attrs:{label:"登录IP",prop:"clientIp"}}),t("el-table-column",{attrs:{label:"登录地址",prop:"clientAddress"}})],1),t("el-pagination",{attrs:{"current-page":e.page.pageCurrent,"page-sizes":[10,20,50,100],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalCount,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},i=[],r=a(88487),l=a(79187),o=a(62978),n=a(56972),d=a(93756),c=a(96208),u=a(95353);const h={name:"OnlineTime",components:{UserTreeSelector:l.A,DateTimePicker:r.A},data(){return{userTypes:n.$o,dates:this.nowDate(),selectedValue:void 0,showUserSelector:!1,page:{beginPageIndex:1,pageCurrent:1,endPageIndex:8,pageSize:20,totalCount:0,totalPage:0},opts:{liveRoomList:[],levelList:[],typeList:n.KO,watchLengthes:[{label:"超过5分钟",value:5},{label:"超过10分钟",value:10},{label:"超过15分钟",value:15},{label:"超过20分钟",value:20},{label:"超过25分钟",value:25},{label:"超过30分钟",value:30},{label:"超过1小时",value:60},{label:"超过1个半小时",value:90},{label:"超过2小时",value:120},{label:"超过2个半小时",value:150},{label:"超过3小时",value:180},{label:"超过5小时",value:300}]},list:[],map:{roomId:void 0,deptId:void 0,parentId:void 0,levelId:void 0,userName:void 0,nickName:void 0,onlineTime:void 0},listLoading:!1}},computed:{...(0,u.L8)(["getUserInfo","getLiveRoomInfo"])},mounted(){this.map.roomId=this.getLiveRoomInfo.id,2!=this.getUserInfo.type||this.getUserInfo.actForUser?this.getUserInfo.actForUser&&2==this.getUserInfo.actForUser.type&&(this.map.parentId=this.getUserInfo.actForUser.userId):this.map.parentId=this.getUserInfo.userId,this.getAllLevel(),this.listForPage()},methods:{watchLength(e){return Math.round(e.onlineTime/60)},nowDate(){const e=new Date,t=e.getFullYear(),a=e.getMonth()+1,s=e.getDate();return[new Date(`${t}-${a}-${s} 00:00:00`),e]},getIndex(e){return(this.page.pageCurrent-1)*this.page.pageSize+e+1},clearSelectedUser(){this.selectedValue=void 0,this.map.parentId=void 0,this.map.deptId=void 0,this.$refs.userTreeSelector&&this.$refs.userTreeSelector.clearSelected&&this.$refs.userTreeSelector.clearSelected()},onTeamUserSelected(e){e?e.selected&&(e.selected.__isUser?(this.map.parentId=e.selected.userId,this.selectedValue=e.selected.userName,this.map.deptId=void 0):(this.map.deptId=e.selected.deptId,this.selectedValue=e.selected.deptName,this.map.parentId=void 0)):this.selectedValue=void 0,this.showUserSelector=!1},exportFn(){this.listForPage(!0)},getAllLevel(){(0,d.vP)({}).then(e=>{this.opts.levelList=e.data.records})},handleSizeChange(e){this.page.pageSize=e,this.page.pageCurrent=1,this.listForPage()},handleCurrentChange(e){this.page.pageCurrent=e,this.listForPage()},handleReset(){this.map={deptId:void 0,parentId:void 0,levelId:void 0,userName:void 0,nickName:void 0,onlineTime:void 0},this.selectedValue=void 0,this.page.pageCurrent=1,this.map.roomId=this.opts.liveRoomList[0].id,this.listForPage()},handleCheck(){this.page.pageCurrent=1,this.listForPage()},listForPage(e=void 0){this.listLoading=!0;const t={pageSize:this.page.pageSize,pageNumber:this.page.pageCurrent,...this.map};if(t.deptId||t.parentId||!this.getUserInfo.actForUser||2==this.getUserInfo.actForUser.type&&(t["parentId"]=this.getUserInfo.actForUser.userId),t.startTime=(0,o.pe)(this.dates[0]),t.endTime=(0,o.pe)(this.dates[1]),t.startTime>t.endTime)return void this.$message.error("选择查询的结束时间不能小于开始时间");let a=this;if(a.listLoading=!0,null==t.startTime||null==t.endTime)return this.$modal.alert("必须选择统计时间段"),t.startTime=void 0,void(t.endTime=void 0);e?(t["$download"]=!0,(0,c.r1)(t).then(e=>{a.listLoading=!1}).catch(e=>{console.error(e),a.listLoading=!1})):(0,c.Tb)(t).then(e=>{a.listLoading=!1,a.page.totalCount=Number(e.data.total),a.page.totalPage=Number(e.data.totalPages),a.page.pageCurrent=Number(e.data.pageNum),a.page.pageSize=Number(e.data.pageSize),a.list=e.data.records}).catch(e=>{a.listLoading=!1,console.error(e)})}}},m=h;var p=a(81656),g=(0,p.A)(m,s,i,!1,null,null,null);const f=g.exports},60460:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var s=function(){var e=this,t=e._self._c;return t("el-form",{ref:"changePasswdForm",staticClass:"change-passwd-form",attrs:{size:"small","label-position":"top","label-width":"70px",model:e.changePasswdForm}},[t("el-form-item",{attrs:{label:"新密码"}},[t("el-input",{attrs:{type:"password",clearable:"",placeholder:"输入新密码"},model:{value:e.changePasswdForm.password,callback:function(t){e.$set(e.changePasswdForm,"password",t)},expression:"changePasswdForm.password"}})],1),t("el-form-item",{attrs:{label:"确认密码"}},[t("el-input",{attrs:{type:"password",clearable:"",placeholder:"再次输入新密码"},model:{value:e.changePasswdForm.repassword,callback:function(t){e.$set(e.changePasswdForm,"repassword",t)},expression:"changePasswdForm.repassword"}})],1),t("el-form-item",{staticClass:"botton-bar"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit()}}},[e._v("确定")]),t("el-button",{on:{click:function(t){return e.onCancel()}}},[e._v("取消")])],1)],1)},i=[],r=a(89613),l=a(95353);const o={name:"ChangePassword",data(){return{changePasswdForm:{userId:null,password:null,repassword:null}}},computed:{...(0,l.L8)(["getUserInfo"])},mounted(){this.changePasswdForm.userId=this.getUserInfo.userId},methods:{onSubmit(){this.changePasswdForm.password?this.changePasswdForm.password!=this.changePasswdForm.repassword?this.$message("两次密码不一致"):(0,r.P)(this.changePasswdForm).then(e=>{this.$message.success("成功修改密码"),this.$emit("confirm",{state:"ok"})}).catch(e=>{this.$message.error("修改密码失败")}):this.$message("密码不能为空")},onCancel(){this.$emit("cancel",{state:"cancel"})}}},n=o;var d=a(81656),c=(0,d.A)(n,s,i,!1,null,"720831c1",null);const u=c.exports},76013:(e,t,a)=>{"use strict";a.d(t,{A:()=>f});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[e.isMobile?t("div",{staticClass:"search-panel"},[t("el-button",{attrs:{icon:e.showSearch?"el-icon-arrow-up":"el-icon-arrow-down",size:"mini"},on:{click:function(t){e.showSearch=!e.showSearch}}},[e._v(e._s(e.showSearch?"收起":"查询"))])],1):e._e(),t("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"68px"}},[t("el-form-item",{attrs:{label:"标题",prop:"title_$lk"}},[t("el-input",{attrs:{placeholder:"请输入回放标题",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery.apply(null,arguments)}},model:{value:e.queryParams.title_$lk,callback:function(t){e.$set(e.queryParams,"title_$lk",t)},expression:"queryParams.title_$lk"}})],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"日期"}},[t("el-date-picker",{attrs:{clearable:"",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.queryParams.date,callback:function(t){e.$set(e.queryParams,"date",t)},expression:"queryParams.date"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")])],1)],1),t("el-row",{staticClass:"card-container",class:e.isMobile?"mobile":"",attrs:{gutter:80}},e._l(e.playbackList,function(a,s){return t("el-col",{key:"channel_"+s,attrs:{span:e.isMobile?24:8}},[t("el-card",{staticClass:"playback-card",class:e.isMobile?"mobile":"",attrs:{"body-style":{padding:"0px"}}},[t("div",{staticClass:"card-title"},[e._v(e._s(e.getTitleWithChannelCode(a))+"【"+e._s(e.fmtDate(a.date,"yyyy-MM-dd"))+" "+e._s(e.fmtDate(a.startTime,"HH:mm"))+"-"+e._s(e.fmtDate(a.endTime,"HH:mm"))+"】")]),t("video",{staticClass:"image",attrs:{src:a.url,controls:""}}),t("div",{staticClass:"card-content"},[t("div",{staticClass:"card-bottom"},[t("div",{staticClass:"time-info-panel"},[t("div",{staticClass:"decs quill-container"},[t("div",{staticClass:"quill-editor",domProps:{innerHTML:e._s(a.decs||"暂无介绍")}})])])])])])],1)}),1),t("pagination",{attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize,pageSizes:[7,15,20,30,50],layout:e.isMobile?"total, prev, pager, next":"total, sizes, prev, pager, next, jumper"},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)},i=[],r=a(50101),l=a(52112);function o(e){return e&&(e=(0,l.Cn)(e)),(0,r.A)({url:"/media/playback/list",method:"post",data:e||{}})}function n(e){return e&&(e=(0,l.Cn)(e)),(0,r.A)({url:"/media/channel/list",method:"post",data:e||{}})}var d=a(62978),c=a(95353),u=a(79247);const h={name:"Playback",components:{Pagination:u.A},dicts:["sys_normal_disable"],data(){return{dialogComponent:null,dialogData:null,dialogTitle:null,dialogWidth:"800px",showDialog:!1,loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,playbackList:[],channelList:[],queryParams:{pageNum:1,pageSize:7,status:1,title_$lk:"",date:""},fmtDate:d.qw}},computed:{...(0,c.L8)(["isMobile","getLiveRoomInfo"])},mounted(){this.getChannel(()=>{this.getList()}),this.isMobile&&(this.showSearch=!1)},methods:{getChannel(e){n({code:this.getLiveRoomInfo.channelCode}).then(t=>{this.channelList=t.data.records,e&&e()})},getTitleWithChannelCode(e){return e.title},closeDialog(){this.showDialog=!1},getList(){this.channelList&&this.channelList.length&&(this.loading=!0,this.queryParams.channelId=this.channelList[0].id,console.log("?",this.queryParams),o(this.queryParams).then(e=>{this.playbackList=e.data.records,e.data.total&&(this.total=Number(e.data.total)),this.loading=!1}))},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.resetForm("queryForm"),this.handleQuery()}}},m=h;var p=a(81656),g=(0,p.A)(m,s,i,!1,null,"581d7b42",null);const f=g.exports},79187:(e,t,a)=>{"use strict";a.d(t,{A:()=>I});var s=function(){var e=this,t=e._self._c;return e.popover?t("el-popover",{attrs:{placement:"bottom",width:"520",trigger:"click",visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"team-tree-select-container"},[t("UserTreeSelectorComponent",{ref:"subComponent",attrs:{visible:e.visible,singleSelect:e.singleSelect,selectedCheckFun:e.selectedCheckFun,selectTeam:e.selectTeam,withFilter:e.withFilter,params:e.params},on:{"update:visible":function(t){e.visible=t},"update:singleSelect":function(t){e.singleSelect=t},"update:single-select":function(t){e.singleSelect=t},"update:selectedCheckFun":function(t){e.selectedCheckFun=t},"update:selected-check-fun":function(t){e.selectedCheckFun=t},"update:selectTeam":function(t){e.selectTeam=t},"update:select-team":function(t){e.selectTeam=t},"update:withFilter":function(t){e.withFilter=t},"update:with-filter":function(t){e.withFilter=t},"update:params":function(t){e.params=t},confirm:e.onSubConfirm}}),e._t("default")],2),t("div",{staticClass:"team-tree-select-input-container",attrs:{slot:"reference"},slot:"reference"},[e._t("reference")],2)]):t("el-dialog",{attrs:{title:"选择用户",visible:e.showDialog,width:"520px","append-to-body":"false",model:!1,"destroy-on-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.showDialog=t},closed:function(t){return e.handleClose()}}},[t("UserTreeSelectorComponent",{ref:"subComponent",attrs:{visible:e.visible,singleSelect:e.singleSelect,selectedCheckFun:e.selectedCheckFun,selectTeam:e.selectTeam,withFilter:e.withFilter,params:e.params},on:{"update:visible":function(t){e.visible=t},"update:singleSelect":function(t){e.singleSelect=t},"update:single-select":function(t){e.singleSelect=t},"update:selectedCheckFun":function(t){e.selectedCheckFun=t},"update:selected-check-fun":function(t){e.selectedCheckFun=t},"update:selectTeam":function(t){e.selectTeam=t},"update:select-team":function(t){e.selectTeam=t},"update:withFilter":function(t){e.withFilter=t},"update:with-filter":function(t){e.withFilter=t},"update:params":function(t){e.params=t},confirm:e.onSubConfirm}}),e._t("default"),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm()}}},[e._v("确 定")]),t("el-button",{on:{click:function(t){return e.handleClose()}}},[e._v("取 消")])],1)],2)},i=[],r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-tree-container"},[e.withFilter?t("div",{staticClass:"type-filter"},[t("div",{staticClass:"type-filter-label"},[e._v("用户类型")]),t("el-checkbox-group",{on:{input:e.changeType},model:{value:e.typeFilter,callback:function(t){e.typeFilter=t},expression:"typeFilter"}},[t("el-checkbox",{attrs:{label:2}},[e._v("管理号")]),t("el-checkbox",{attrs:{label:3}},[e._v("助理")]),t("el-checkbox",{attrs:{label:4}},[e._v("嘉宾")]),t("el-checkbox",{attrs:{label:1}},[e._v("用户")]),t("el-checkbox",{attrs:{label:0}},[e._v("游客")])],1)],1):e._e(),e.showTree?t("el-tree",{ref:"tree",staticClass:"tree",attrs:{data:e.treeData,lazy:!0,load:e.treeNodeLoad,props:e.defaultProps,"node-key":"id","highlight-current":!1,"expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function({node:a}){return t("div",{staticClass:"tree-node-panel"},[t("div",{staticClass:"tree-node-title-panel"},[!a.data.isLoadMore&&(e.selectTeam||a.data.isUser&&a.data._data.type>=0)?t("el-checkbox",{attrs:{"true-label":1,"false-label":0},on:{change:function(t){return e.selectNode(a,a.data._data)}},model:{value:a.data._data.__checked,callback:function(t){e.$set(a.data._data,"__checked",t)},expression:"node.data._data.__checked"}}):e._e(),t("svg-icon",{attrs:{"class-name":"tree-node-icon","icon-class":e.getNodeIcon(a)}}),t("span",[e._v(e._s(a.label))]),a.data.isUser&&!a.data.isLoadMore?t("span",[e._v(":"+e._s(4==a.data._data.type&&a.data._data.lecturerName?a.data._data.lecturerName:a.data._data.nickName))]):e._e(),!a.data.isLoadMore&&a.data.isUser?t("span",[e._v("("+e._s(e.getNodeUserType(a))+")")]):e._e()],1)])}}],null,!1,689133171)}):e._e()],1)},l=[],o=(a(44114),a(18111),a(7588),a(61701),a(42302)),n=a(64976);function d(e,t,a,s,i,r,l){if((e.page&&e.page.pageNumber<=t.data.totalPages&&t.data.pageNum<=t.data.totalPages||!e.page&&t.data.pageNum<=t.data.totalPages)&&t.data.pageNum<t.data.totalPages&&a.push({id:"L_"+(0,o.A)(),parentId:null,userName:"加载更多",parentUserName:null,isUser:l,isLoadMore:!0,_node:e}),e.page={pageNumber:t.data.pageNum,total:t.data.total,totalPages:t.data.totalPages},r){if(r.treeData||(r.treeData=[]),r.treeData.length>0?a&&a.length>0?r.treeData.splice(r.treeData.length-1,1,...a):r.treeData.splice(r.treeData.length-1,1):a&&a.length>0&&r.treeData.splice(0,0,...a),r.childNodes&&r.childNodes.length>0){let e=r.childNodes[r.childNodes.length-1];r.removeChild(e)}a.forEach(t=>{let a=new n.A({data:t,parent:r,store:r.store});a.data._node=r,a.params=s,a.page=e.page,r.insertChild(a,r.childNodes.length)}),i([])}else e.params=s,e.treeData=a,i(a)}function c(e,t){t.data&&t.data._data&&e.$set(t.data._data,"__checked",0);const a=e=>e.parent?a(e.parent):e,s=t=>{t&&t.data&&t.data._data&&e.$set(t.data._data,"__checked",0),t&&t.childNodes&&t.childNodes.forEach(e=>{s(e)})},i=a(t);s(i)}var u=a(62978),h=a(96208),m=a(95353);const p={name:"UserTreeSelectorComponent",props:{visible:{type:Boolean,default:!1},singleSelect:{type:Boolean,default:!1},selectedCheckFun:Function,selectTeam:{type:Boolean,default:!1},withFilter:{type:Boolean,default:!1},params:{type:Object,default:()=>({})}},data(){return{queryParams:{},treeData:void 0,confirmOnSelect:{type:Boolean,default:!1},defaultProps:{children:"children",label:"userName"},checkFun:null,currentSelected:null,typeFilter:[],showTree:!0}},computed:{...(0,m.L8)(["getUserInfo","getLiveRoomInfo"])},watch:{params(e){this.queryParams=Object.assign({},this.queryParams,e)}},mounted(){this.queryParams=Object.assign({},this.queryParams,this.params),this.checkFun=this.selectedCheckFun},methods:{getNodeIcon(e){return(0,u.VF)(e.data)},changeType(){this.showTree=!1;let e=this;setTimeout(()=>{e.showTree=!0},200)},getNodeUserType(e){return(0,u.jV)(e.data)},show(e,t){this.queryParams=e||{},this.checkFun=t},clearSelected(){let e=this.$refs.tree.root;const t=e=>{e.childNodes&&e.childNodes.forEach(e=>{e.data&&e.data._data&&e.data._data.__checked&&(e.data._data.__checked=!1),e.childNodes&&t(e)})};t(e)},selectNode(e,t){let a=t.__checked;this.singleSelect&&c(this,e),this.currentSelected=a?t:null,this.$set(t,"__checked",a),this.confirmOnSelect&&this.$nextTick(()=>{this.handleConfirm()})},treeNodeLoad(e,t){if(e.handler={node:e,resolve:t},e.data&&e.data.isLoadMore)if(e.data.isUser){let a=e.data._node.params;a.pageNumber++,this.listUser(a,e,t,e.data._node)}else{let a=e.data._node.params;a.pageNumber++,this.listTeam(a,e,t,e.data._node)}else if(0==e.level)if(3==this.getUserInfo.type||4==this.getUserInfo.type||this.getUserInfo.actForUser&&(3==this.getUserInfo.actForUser.type||4==this.getUserInfo.actForUser.type)||(2!=this.getUserInfo.type||this.getUserInfo.actForUser?this.getUserInfo.actForUser&&2==this.getUserInfo.actForUser.type&&(this.queryParams.userId=this.getUserInfo.actForUser.userId):this.queryParams.userId=this.getUserInfo.userId),this.queryParams.parentId||this.queryParams.userId)if(this.queryParams.parentId){let a={parentId:this.queryParams.parentId,type:(this.typeFilter&&this.typeFilter.length?this.typeFilter:null)||this.queryParams.type||[2,3,4],pageNumber:1,pageSize:35};this.listUser(a,e,t)}else if(this.queryParams.userId){let a={userId:this.queryParams.userId,type:(this.typeFilter&&this.typeFilter.length?this.typeFilter:null)||this.queryParams.type||[2,3,4],pageNumber:1,pageSize:35};this.listUser(a,e,t)}else this.$modal.confirm("参数不能为空"),t([]);else{let a={pageNumber:1,pageSize:35};this.queryParams.deptId&&(a.deptId=this.queryParams.deptId),this.listTeam(a,e,t)}else{var a={pageNumber:1,pageSize:35};e.data.isUser?a.parentId=e.data.id.replace(/^[TU_]+/g,""):(a.deptId=e.data.id.replace(/^[TU_]+/g,""),a.parentId="0"),a.type=(this.typeFilter&&this.typeFilter.length?this.typeFilter:null)||this.queryParams.type||[2,3,4],this.listUser(a,e,t)}},listTeam(e,t,a,s){let i=this;(0,h.cf)(e).then(r=>{this.deptList=r.data.records;const l=r.data.records.map(e=>{let t={id:"T_"+e.deptId,deptId:e.deptId,parentId:null,userName:e.deptName,isUser:!1,_data:e};return t._data.__isUser=!1,null!=i.checkFun&&i.checkFun instanceof Function&&i.checkFun(e)&&(t._data.__checked=1),t});d(t,r,l,e,a,s,!1)})},listUser(e,t,a,s){let i=this;(0,h.IK)(e).then(r=>{const l=r.data.records.map(e=>{let a={id:"U_"+e.userId,deptId:e.deptId,parentId:t.data&&t.data.id?t.data.id:null,userName:e.userName,isUser:!0,_data:e};return a._data.__isUser=!0,null!=i.checkFun&&i.checkFun instanceof Function&&i.checkFun(e)&&(a._data.__checked=1),a});d(t,r,l,e,a,s,!0)})},handleConfirm(){let e=[];if(this.queryParams.callback&&this.queryParams.callback instanceof Function){let t=this.$refs.tree.root;const a=t=>{t.childNodes&&t.childNodes.forEach(t=>{t.data&&t.data._data&&t.data._data.__checked&&e.push(t.data._data),t.childNodes&&a(t)})};a(t),this.queryParams.callback&&this.queryParams.callback instanceof Function&&this.queryParams.callback(e).then(()=>{this.$modal.msgSuccess("设置成功")})}this.$emit("update:visible",!1),this.$emit("confirm",{selected:this.currentSelected,selectedList:e})}}},g=p;var f=a(81656),v=(0,f.A)(g,r,l,!1,null,"08e355b8",null);const y=v.exports,b={name:"UserTreeSelector",components:{UserTreeSelectorComponent:y},props:{visible:{type:Boolean,default:!1},popover:{type:Boolean,default:!1},selectedValue:String,confirmOnSelect:{type:Boolean,default:!1},singleSelect:{type:Boolean,default:!1},selectedCheckFun:Function,selectTeam:{type:Boolean,default:!1},withFilter:{type:Boolean,default:!1},params:{type:Object,default:()=>({})}},data(){return{showDialog:this.visible,fixedValue:void 0}},watch:{visible(e){this.showDialog=e}},methods:{show(e,t){this.showDialog=!0,this.$nextTick(()=>{this.$refs.subComponent&&this.$refs.subComponent.show&&this.$refs.subComponent.show(e,t)})},clear(){this.$emit("confirm",void 0)},onSubConfirm(e){this.$emit("confirm",e)},clearSelected(){this.$refs.subComponent&&this.$refs.subComponent.clearSelected&&this.$refs.subComponent.clearSelected()},handleConfirm(){this.showDialog=!1,this.$refs.subComponent&&this.$refs.subComponent.handleConfirm&&this.$refs.subComponent.handleConfirm(),this.$emit("update:visible",!1)},handleClose(){this.showDialog=!1,this.$emit("update:visible",!1)}}},w=b;var _=(0,f.A)(w,s,i,!1,null,"74042cdb",null);const I=_.exports},79247:(e,t,a)=>{"use strict";a.d(t,{A:()=>m});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[t("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,"pager-count":e.pagerCount,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},i=[];Math.easeInOutQuad=function(e,t,a,s){return e/=s/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function l(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function n(e,t,a){const s=o(),i=e-s,n=20;let d=0;t="undefined"===typeof t?500:t;var c=function(){d+=n;var e=Math.easeInOutQuad(d,s,i,t);l(e),d<t?r(c):a&&"function"===typeof a&&a()};c()}const d={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default(){return[10,20,30,50]}},pagerCount:{type:Number,default:document.body.clientWidth<992?5:7},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},data(){return{}},computed:{currentPage:{get(){return this.page},set(e){this.$emit("update:page",e)}},pageSize:{get(){return this.limit},set(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange(e){this.currentPage*e>this.total&&(this.currentPage=1),this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&n(0,800)},handleCurrentChange(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&n(0,800)}}},c=d;var u=a(81656),h=(0,u.A)(c,s,i,!1,null,"cf1facd6",null);const m=h.exports},88487:(e,t,a)=>{"use strict";a.d(t,{A:()=>L});var s=function(){var e=this,t=e._self._c;return t("div",{ref:"popover",staticClass:"popover-container",class:e.containerClass},[e.showError?t("div",{staticClass:"input-container error",class:e.inputClass+" "+e.size},[e._v(" "+e._s(e.errorMsg)+" ")]):e._e(),t("div",{ref:"triggerWrapper",staticClass:"input-container",class:e.inputClass+" "+e.size},[t("div",{staticClass:"input-seg",class:e.isRange?"range "+e.size:e.size},["time"!==e.layoutModel?t("div",{staticClass:"input-panel",class:e.layoutModel+" "+e.size,on:{click:function(t){e.showPanel="date0"}}},[e._v(e._s(e.fixedDateValue0||"----"))]):e._e(),"date"!==e.layoutModel?t("div",{staticClass:"input-panel",class:e.layoutModel+" "+e.size,on:{click:function(t){e.showPanel="time0"}}},[e._v(e._s(e.fixedTimeValue0||"--"))]):e._e(),"time"!==e.layoutModel?t("input",{ref:"triggerWrapperSub",staticClass:"input-item",class:"datetime"==e.layoutModel?"datetime":"",attrs:{readonly:"",placeholder:"选择日期"},domProps:{value:e.fixedDateValue0}}):e._e(),"date"!==e.layoutModel?t("input",{ref:"triggerWrapperSub",staticClass:"input-item",class:"datetime"==e.layoutModel?"datetime":"",attrs:{readonly:"",placeholder:"选择时间"},domProps:{value:e.fixedTimeValue0}}):e._e()]),e.isRange?t("div",{ref:"triggerWrapperSubSep",staticClass:"input-separator",class:e.size,style:e.separatorStype},[e._v("-")]):e._e(),e.isRange?t("div",{staticClass:"input-seg",class:e.isRange?"range "+e.size:"size"},[e.isRange&&"time"!==e.layoutModel?t("div",{staticClass:"input-panel",class:e.layoutModel+" "+e.size,on:{click:function(t){e.showPanel="date1"}}},[e._v(e._s(e.fixedDateValue1||"----"))]):e._e(),e.isRange&&"date"!==e.layoutModel?t("div",{staticClass:"input-panel",class:e.layoutModel+" "+e.size,on:{click:function(t){e.showPanel="time1"}}},[e._v(e._s(e.fixedTimeValue1||"--"))]):e._e(),e.isRange&&"time"!==e.layoutModel?t("input",{ref:"triggerWrapperSub",staticClass:"input-item",class:"datetime"==e.layoutModel?"datetime":"",attrs:{readonly:"",placeholder:"选择日期"},domProps:{value:e.fixedDateValue1}}):e._e(),e.isRange&&"date"!==e.layoutModel?t("input",{ref:"triggerWrapperSub",staticClass:"input-item",class:"datetime"==e.layoutModel?"datetime":"",attrs:{readonly:"",placeholder:"选择时间"},domProps:{value:e.fixedTimeValue1}}):e._e()]):e._e()]),t("span",{directives:[{name:"show",rawName:"v-show",value:e.fixedDateValue0||e.fixedTimeValue0,expression:"fixedDateValue0 || fixedTimeValue0"}],staticClass:"popover-input-clear",class:e.inputClass,on:{click:function(t){return t.stopPropagation(),e.clear.apply(null,arguments)}}},[t("i",{staticClass:"el-icon-circle-close"})]),t("div",{ref:"popoverWrapper",staticClass:"main-datepicker-pick-container",class:e.datePickPopoverVisible?"main-datepicker-visible":""},["time"!==e.layoutModel?t("DatePanel",{directives:[{name:"show",rawName:"v-show",value:"date0"===e.showPanel,expression:"showPanel==='date0'"}],ref:"subPanel",staticClass:"main-datepicker-pick-select-panel",model:{value:e.date0,callback:function(t){e.date0=t},expression:"date0"}}):e._e(),"date"!==e.layoutModel?t("TimePanel",{directives:[{name:"show",rawName:"v-show",value:"time0"===e.showPanel,expression:"showPanel==='time0'"}],ref:"subPanel",staticClass:"main-datepicker-pick-select-panel",attrs:{defaultSecond:e.defaultStartSecond,showSecond:e.showSecond},model:{value:e.time0,callback:function(t){e.time0=t},expression:"time0"}}):e._e(),e.isRange&&"time"!==e.layoutModel?t("DatePanel",{directives:[{name:"show",rawName:"v-show",value:"date1"===e.showPanel,expression:"showPanel==='date1'"}],ref:"subPanel",staticClass:"main-datepicker-pick-select-panel",model:{value:e.date1,callback:function(t){e.date1=t},expression:"date1"}}):e._e(),e.isRange&&"date"!==e.layoutModel?t("TimePanel",{directives:[{name:"show",rawName:"v-show",value:"time1"===e.showPanel,expression:"showPanel==='time1'"}],ref:"subPanel",staticClass:"main-datepicker-pick-select-panel",attrs:{defaultSecond:e.defaultEndSecond,showSecond:e.showSecond},model:{value:e.time1,callback:function(t){e.time1=t},expression:"time1"}}):e._e()],1)])},i=[];const r={props:{position:{type:String,default:"bottom",validator(e){return["top","bottom","left","right"].indexOf(e)>=0}}},mounted(){setTimeout(()=>{this.registerActions()},300)},methods:{registerActions(){let e=this;function t(t){e.$refs.popover&&(e.$refs.popover===t.target||e.$refs.popover.contains(t.target))||e.$refs.popoverWrapper&&(e.$refs.popoverWrapper===t.target||e.$refs.popoverWrapper.contains(t.target))||r()}let a=null;function s(t){e.$refs.triggerWrapper.contains(t.target)&&(!0===e[e.__visibleFlagField]&&a==t.target?r():(a=t.target,i()))}function i(){e[e.__visibleFlagField]=!0,e.$nextTick(()=>{l(),document.addEventListener("click",t)})}function r(){e[e.__visibleFlagField]=!1,e.__closeAction&&e[e.__closeAction]&&e[e.__closeAction]instanceof Function&&e[e.__closeAction](),document.removeEventListener("click",t)}function l(){const{triggerWrapper:t,popoverWrapper:a}=e.$refs;let{width:s,height:i,top:r,left:l}=t.getBoundingClientRect(),{height:o,width:n}=a.getBoundingClientRect(),d=window.innerWidth||document.body.clientWidth,c=window.innerHeight||document.body.clientHeight,u=e=>{let t={top:{top:r+window.pageYOffset,left:l+window.pageXOffset},bottom:{top:r+i+window.pageYOffset,left:l+window.pageXOffset},left:{top:r+(i-o)/2+window.pageYOffset,left:l+window.pageXOffset},right:{top:r+(i-o)/2+window.pageYOffset,left:l+s+window.pageXOffset}},a=t[e].left;a+n>d&&(a-=a+n-d);let u=t[e].top;return u+o>c&&(u-=u+o-c),{top:u,left:a}},h=u(e.position);a.style.left=h.left+"px",a.style.top=h.top+"px"}e.$refs.popover.addEventListener("click",s)}}};var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"date-panel-container"},[t("div",{staticClass:"date-panel-header"},[t("div",{staticClass:"date-panel-header-btn",attrs:{type:"button"},on:{click:e.prevYear}},[e._v(" << ")]),t("div",{staticClass:"date-panel-header-btn",attrs:{type:"button"},on:{click:e.prevMonth}},[e._v(" < ")]),t("div",{staticClass:"date-panel-header-label"},[t("span",{staticClass:"date-panel-header-label-text"},[e._v(e._s(e.yearLabel))]),t("span",[e._v("-")]),t("span",{staticClass:"date-panel-header-label-text"},[e._v(e._s(e.monthLabel))])]),t("div",{staticClass:"date-panel-header-btn",attrs:{type:"button"},on:{click:e.nextMonth}},[e._v(" > ")]),t("div",{staticClass:"date-panel-header-btn",attrs:{type:"button"},on:{click:e.nextYear}},[e._v(" >> ")])]),t("table",{staticClass:"full date-picker-date-table",attrs:{cellspacing:"0",cellpadding:"0"}},[t("tbody",[t("tr",e._l(e.WeekLabels,function(a,s){return t("th",{key:s},[e._v(e._s(e.getWeekLabel(a,s)))])}),0),e._l(e.rows,function(a,s){return t("tr",{key:"row_"+s,staticClass:"date-picker-date-table__row"},e._l(a,function(a,i){return t("td",{key:"col_"+i,class:e.getCellClasses(a),on:{click:function(t){return e.selectDay(s,i)}}},[t("div",[t("span",[e._v(" "+e._s(a.text)+" ")])])])}),0)})],2)])])},o=[],n=(a(44114),a(18111),a(81148),a(13579),a(82956));const d=function(e){return"number"===typeof e||"string"===typeof e?(0,n.$U)(new Date(e)).getTime():e instanceof Date?(0,n.$U)(e).getTime():NaN},c=["一","二","三","四","五","六","日"],u={name:"DatePanel",model:{event:"update"},props:{firstDayOfWeek:{default:7,type:Number,validator:e=>e>=1&&e<=7},value:{},defaultValue:{validator(e){return null===e||(0,n.$P)(e)||Array.isArray(e)&&e.every(n.$P)}},disabledDate:{},cellClassName:{},minDate:{},maxDate:{}},computed:{yearLabel(){return this.date?this.date.getFullYear():(new Date).getFullYear()},monthLabel(){return this.date?this.date.getMonth()+1:(new Date).getMonth()+1},dayLabel(){return this.date.getDay()+1},offsetDay(){const e=this.firstDayOfWeek;return e>3?7-e:-e},year(){return this.date?this.date.getFullYear():(new Date).getFullYear()},month(){return this.date.getMonth()},rows(){const e=new Date(this.year,this.month,1);let t=(0,n.mW)(e);const a=(0,n.BF)(e.getFullYear(),e.getMonth()),s=(0,n.BF)(e.getFullYear(),0===e.getMonth()?11:e.getMonth()-1);t=0===t?7:t;const i=this.offsetDay,r=this.tableRows;let l=1;const o=this.startDate,c=this.disabledDate,u=this.cellClassName,h=(0,n.XD)(this.value),m=d(new Date);for(let p=0;p<6;p++){const e=r[p];for(let r=0;r<7;r++){let g=e[r];g||(g={row:p,column:r,type:"normal",start:!1,end:!1}),g.type="normal";const f=7*p+r,v=(0,n.i6)(o,f-i).getTime();g.start=this.minDate&&v===d(this.minDate),g.end=this.maxDate&&v===d(this.maxDate);const y=v===m;if(y&&(g.type="today"),p>=0&&p<=1){const e=t+i<0?7+t+i:t+i;r+7*p>=e?g.text=l++:(g.text=s-(e-r%7)+1+7*p,g.type="prev-month")}else l<=a?g.text=l++:(g.text=l++-a,g.type="next-month");let b=new Date(v);g.disabled="function"===typeof c&&c(b),g.selected=(0,n.L9)(h,e=>e.getTime()===b.getTime()),g.customClass="function"===typeof u&&u(b),this.$set(e,r,g)}}return r},startDate(){return(0,n.cY)(this.year,this.month)}},watch:{value(e){this.date=e||new Date}},data(){return{date:null,WeekLabels:[],tableRows:[[],[],[],[],[],[]],lastRow:null,lastColumn:null}},beforeMount(){this.date=this.value||new Date},mounted(){this.WeekLabels=c.concat(c).slice(this.firstDayOfWeek-1,this.firstDayOfWeek-1+7)},methods:{prevMonth(){this.date=(0,n.uH)(this.date)},nextMonth(){this.date=(0,n.wc)(this.date)},prevYear(){"year"===this.currentView?this.date=(0,n.jt)(this.date,10):this.date=(0,n.jt)(this.date)},nextYear(){"year"===this.currentView?this.date=(0,n.le)(this.date,10):this.date=(0,n.le)(this.date)},getWeekLabel(e,t){return this.WeekLabels[t]},cellMatchesDate(e,t){const a=new Date(t);return this.year===a.getFullYear()&&this.month===a.getMonth()&&Number(e.text)===a.getDate()},getCellClasses(e){const t=this.selectionMode,a=this.defaultValue?Array.isArray(this.defaultValue)?this.defaultValue:[this.defaultValue]:[];let s=[];return"normal"!==e.type&&"today"!==e.type||e.disabled?s.push(e.type):(s.push("available"),"today"===e.type&&s.push("today")),"normal"===e.type&&a.some(t=>this.cellMatchesDate(e,t))&&s.push("default"),"day"!==t||"normal"!==e.type&&"today"!==e.type||!this.cellMatchesDate(e,this.value)||s.push("current"),e.disabled&&s.push("disabled"),e.selected&&s.push("selected"),e.customClass&&s.push(e.customClass),s.join(" ")},selectDay(e,t){const a=7*e+(t-0)-this.offsetDay;let s=(0,n.i6)(this.startDate,a);this.$emit("update",s)}}},h=u;var m=a(81656),p=(0,m.A)(h,l,o,!1,null,"f02d9c94",null);const g=p.exports;var f=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-timepicker-panel-card"},[t("div",{staticClass:"timepicker-panel-full"},[t("div",{staticClass:"timepicker-panel-header"},[e._v("选择小时")]),e._l(e.hlist,function(a,s){return t("div",{key:"tpphh_"+s,staticClass:"timepicker-item-hours",class:e.isSelected("hoursSel",a)?"selected":"",on:{click:function(t){return e.select("hours",a)}}},[t("span",[e._v(e._s(a))])])})],2),t("div",{staticClass:"timepicker-panel-full"},[t("div",{staticClass:"timepicker-panel-header"},[e._v("选择分钟")]),e._l(e.mlist,function(a,s){return t("div",{key:"tpphm_"+s,staticClass:"timepicker-item-minutes",class:e.isSelected("minutesSel",a)?"selected":"",on:{click:function(t){return e.select("minutes",a)}}},[t("span",[e._v(e._s(a))])])})],2),!1!==e.showSecond?t("div",{staticClass:"timepicker-panel-full"},[t("div",{staticClass:"timepicker-panel-header"},[e._v("选择秒")]),e._l(e.mlist,function(a,s){return t("div",{key:"tpphs_"+s,staticClass:"timepicker-item-seconds",class:e.isSelected("secondsSel",a)?"selected":"",on:{click:function(t){return e.select("seconds",a)}}},[t("span",[e._v(e._s(a))])])})],2):e._e()])},v=[];const y={name:"TimePanel",model:{event:"update"},props:{value:[String],showSecond:{type:Boolean,default:!0},defaultSecond:{type:String,default:"00"},inputClass:{type:String,default:""}},data(){return{timeItem:{hours:null,minutes:null,seconds:null,hoursSel:null,minutesSel:null,secondsSel:null,currentValue:null},hlist:[...Array(24).keys()].map(e=>1==(""+e).length?"0"+e:""+e),mlist:[...Array(60).keys()].map(e=>1==(""+e).length?"0"+e:""+e)}},width:{value(e){this.init()}},mounted(){this.init()},methods:{init(){this.timeItem.currentValue=this.fixDateTime(),this.initTimeItem(this.timeItem)},initTimeItem(e){let t=e.currentValue.split(":");e.hours=t[0],e.minutes=t[1],e.seconds=!1!==this.showSecond?t[2]:this.defaultSecond,e.hoursSel=e.hours,e.minutesSel=e.minutes,e.secondsSel=!1!==this.showSecond?e.seconds:null},select(e,t){this.timeItem[e+"Sel"]=t,this.timeItem[e]=t,this.timeItem.currentValue=!1===this.showSecond?this.timeItem.hours+":"+this.timeItem.minutes:this.timeItem.hours+":"+this.timeItem.minutes+":"+this.timeItem.seconds;let a=!1===this.showSecond?this.timeItem.currentValue+":"+this.defaultSecond:this.timeItem.currentValue;/^([\d]+:)([\d]+)$/g.test(a)&&(a=a+":"+this.defaultSecond);let s=this;this.$nextTick(()=>{s.$emit("update",a)})},isSelected(e,t){return this.timeItem[e]===t},fixDateTime(){let e=new Date;return this.value&&(e=this.value),this.getDateString(e)},getDateString(e){if("string"===typeof e){let t=new Date(e);e=isNaN(t.getTime())?new Date:t}else e instanceof Date||(e=new Date);const t=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0"),s=String(e.getSeconds()).padStart(2,"0");return!1===this.showSecond?/^\d\d:\d\d$/.test(e)||/^\d\d:\d\d:\d\d$/.test(e)?/^\d\d:\d\d:\d\d$/.test(e)?e.replace(/:\d\d$/,""):e:`${t}:${a}`:/^\d\d:\d\d:\d\d$/.test(e)?e:`${t}:${a}:${s}`}}},b=y;var w=(0,m.A)(b,f,v,!1,null,"f6fc690a",null);const _=w.exports;var I=a(95093),k=a.n(I),C=a(52112);function x(e){e.date0||e.time0||e.date1||e.time1?(e.fixedDateValue0=e.date0?(0,C.qw)(k()(e.date0,(0,n.L$)(e.date0)).toDate(),"yyyy-MM-dd"):(0,C.qw)(new Date,"yyyy-MM-dd"),e.fixedTimeValue0=e.time0?(0,C.qw)(k()(e.time0,(0,n.L$)(e.time0)).toDate(),e.showSecond?"HH:mm:ss":"HH:mm"):(0,C.qw)(new Date,e.showSecond?"HH:mm:ss":"HH:mm"),e.fixedDateValue1=e.date1?(0,C.qw)(k()(e.date1,(0,n.L$)(e.date1)).toDate(),"yyyy-MM-dd"):(0,C.qw)(new Date,"yyyy-MM-dd"),e.fixedTimeValue1=e.time1?(0,C.qw)(k()(e.time1,(0,n.L$)(e.time1)).toDate(),e.showSecond?"HH:mm:ss":"HH:mm"):(0,C.qw)(new Date,e.showSecond?"HH:mm:ss":"HH:mm")):(e.fixedDateValue0=void 0,e.fixedTimeValue0=void 0,e.fixedDateValue1=void 0,e.fixedTimeValue1=void 0)}const S={name:"DateTimePicker",components:{DatePanel:g,TimePanel:_},mixins:[r],model:{event:"update"},props:{value:{type:[String,Array]},containerClass:{type:String,default:""},inputClass:{type:String,default:""},size:{type:String,default:"medium",validate:e=>["medium","small","mini"].indexOf(e)>=0},layoutModel:{type:String,default:"datetime",validate:e=>["datetime","date","time"].indexOf(e)>=0},showSecond:{type:Boolean,default:!0},defaultStartSecond:{type:String,default:"00"},defaultEndSecond:{type:String,default:"59"},isRange:{type:Boolean,default:!1}},data(){return{datePickPopoverVisible:!1,date0:void 0,time0:void 0,date1:void 0,time1:void 0,fixedDateValue0:null,fixedTimeValue0:null,fixedDateValue1:null,fixedTimeValue1:null,showPanel:"date0",separatorStype:"",errorMsg:"",showError:!1}},watch:{date0(e){x(this),this.fireUpdate()},time0(e){x(this),this.fireUpdate()},date1(e){x(this),this.fireUpdate()},time1(e){x(this),this.fireUpdate()}},beforeMount(){this.isRange?!(this.value instanceof Array)||this.value instanceof Array&&2!=this.value.length||(null!=this.value[0]&&(this.date0=k()(this.value[0],(0,n.L$)(this.value[0])).toDate()),null!=this.value[1]&&(this.date1=k()(this.value[1],(0,n.L$)(this.value[1])).toDate()),this.showSecond?(this.time0=this.date0?(0,C.qw)(this.date0,"HH:mm:ss"):null,this.time1=this.date1?(0,C.qw)(this.date1,"HH:mm:ss"):null):(this.time0=this.date0?(0,C.qw)(this.date0,"HH:mm"):null,this.time1=this.date1?(0,C.qw)(this.date1,"HH:mm"):null)):(null!=this.value&&(this.date0=k()(this.value,(0,n.L$)(this.value)).toDate()),this.showSecond?this.time0=this.date0?(0,C.qw)(this.date0,"HH:mm:ss"):null:this.time0=this.date0?(0,C.qw)(this.date0,"HH:mm"):null),this.__visibleFlagField="datePickPopoverVisible",this.__closeAction="close"},mounted(){if(this.isRange&&this.$refs.triggerWrapperSubSep&&this.$refs.triggerWrapper){let e=this;this.$nextTick(()=>{const t=e.$refs.triggerWrapper.getBoundingClientRect(),a=e.$refs.triggerWrapperSubSep.getBoundingClientRect(),s=t.width/2,i=a.width/2;e.separatorStype="left:"+(s-i)+"px;"})}},methods:{close(){"datetime"==this.layoutModel&&(this.isRange?void 0!=this.fixedDateValue0&&void 0!=this.fixedTimeValue0&&void 0!=this.fixedDateValue1&&void 0!=this.fixedTimeValue1||(this.fixedDateValue0=void 0,this.fixedTimeValue0=void 0,this.fixedDateValue1=void 0,this.fixedTimeValue1=void 0):void 0!=this.fixedDateValue0&&void 0!=this.fixedTimeValue0||(this.fixedDateValue0=void 0,this.fixedTimeValue0=void 0)),this.fireUpdate()},fireUpdate(){if(this.isRange){const e=[];if("time"==this.layoutModel?void 0==this.fixedTimeValue0?e[0]=null:(this.showSecond||/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue0))&&/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue0)?e[0]=this.fixedTimeValue0:e[0]=this.fixedTimeValue0+":"+this.defaultStartSecond:"date"==this.layoutModel?void 0==this.fixedDateValue0?e[0]=null:e[0]=this.fixedDateValue0:void 0==this.fixedDateValue0||void 0==this.fixedTimeValue0?e[0]=null:(this.showSecond||/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue0))&&/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue0)?e[0]=this.fixedDateValue0+" "+this.fixedTimeValue0:e[0]=this.fixedDateValue0+" "+this.fixedTimeValue0+":"+this.defaultStartSecond,"time"==this.layoutModel?void 0==this.fixedTimeValue1?e[1]=null:(this.showSecond||/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue1))&&/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue1)?e[1]=this.fixedTimeValue1:e[1]=this.fixedTimeValue1+":"+this.defaultEndSecond:"date"==this.layoutModel?void 0==this.fixedDateValue1?e[1]=null:e[1]=this.fixedDateValue1:void 0==this.fixedDateValue1||void 0==this.fixedTimeValue1?e[1]=null:(this.showSecond||/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue1))&&/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue1)?e[1]=this.fixedDateValue1+" "+this.fixedTimeValue1:e[1]=this.fixedDateValue1+" "+this.fixedTimeValue1+":"+this.defaultEndSecond,e[1]<e[0]){this.errorMsg="结束时间不能早于开始时间",e[1]=e[0],this.date1=this.date0,this.time1=this.time0,this.$emit("update",e),this.showError=!0;const t=()=>{this.showError=!1};this.$nextTick(()=>{let e=this.$refs.subPanel;e&&e.init&&e.init instanceof Function&&e.init()}),setTimeout(t,1e3)}else this.$emit("update",e)}else"time"==this.layoutModel?void 0==this.fixedTimeValue0?this.$emit("update",void 0):(this.showSecond||/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue0))&&/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue0)?this.$emit("update",this.fixedTimeValue0):this.$emit("update",this.fixedTimeValue0+":"+this.defaultStartSecond):"date"==this.layoutModel?void 0==this.fixedDateValue0?this.$emit("update",void 0):this.$emit("update",this.fixedDateValue0):void 0==this.fixedDateValue0||void 0==this.fixedTimeValue0?this.$emit("update",void 0):(this.showSecond||/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue0))&&/^([\d]){2}:([\d]){2}:([\d]){2}$/.test(this.fixedTimeValue0)?this.$emit("update",this.fixedDateValue0+" "+this.fixedTimeValue0):this.$emit("update",this.fixedDateValue0+" "+this.fixedTimeValue0+":"+this.defaultStartSecond)},clear(){this.fixedDateValue0=void 0,this.fixedTimeValue0=void 0,this.fixedDateValue1=void 0,this.fixedTimeValue1=void 0,this.fireUpdate()}}},D=S;var P=(0,m.A)(D,s,i,!1,null,"db835446",null);const L=P.exports},89613:(e,t,a)=>{"use strict";a.d(t,{P:()=>r,T:()=>i});var s=a(50101);function i(e,t={}){return s.A.post("/app/user/update",e,t)}function r(e,t={}){return s.A.post("/app/user/updatePswd",e,t)}},96208:(e,t,a)=>{"use strict";a.d(t,{IK:()=>l,P0:()=>d,Tb:()=>c,Xx:()=>m,c$:()=>h,cf:()=>r,gw:()=>n,oB:()=>o,r1:()=>u});var s=a(50101),i=a(52112);function r(e){return e&&(e=(0,i.Cn)(e)),(0,s.A)({url:"/base/sysDept/list",method:"post",data:e||{},headers:{skipRepeats:!0}})}function l(e){return(0,s.A)({url:"/base/user/list",method:"post",data:(0,i.Cn)(e),headers:{skipRepeats:!0}})}function o(e){return(0,s.A)({url:"/live/chapterItem/listByRoomAndDate",method:"post",data:e})}function n(e){return(0,s.A)({url:"/base/userStatics/course",method:"post",data:e})}function d(e){return e&&(e=(0,i.Cn)(e)),(0,s.A)({url:"/base/userWsLog/getOnlineUserList",method:"post",data:e||{}})}const c=e=>(0,s.A)({url:"/base/userWsLog/getOnlineUserTime",method:"post",data:e||{}}),u=e=>(0,s.A)({url:"/base/userWsLog/downloadOnlineUserTime",method:"post",data:e||{},headers:{download:!0,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}),h=e=>(0,s.A)({url:"/base/userStatics/hours",method:"post",data:e||{}});function m(e){return(0,s.A)({url:"/live/room/roomUserKickout",method:"post",data:e})}},98374:(e,t,a)=>{"use strict";a.d(t,{A:()=>p});a(18111),a(61701);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("el-form",{staticClass:"filter-container",attrs:{inline:"","label-width":"90px",size:"mini"}},[t("el-form-item",{staticClass:"filter-item",attrs:{label:"团队",prop:"teamId"}},[t("UserTreeSelector",{ref:"userTreeSelector",attrs:{popover:"",selectTeam:"",singleSelect:"",confirmOnSelect:"",visible:e.showUserSelector,selectedValue:e.selectedValue},on:{"update:visible":function(t){e.showUserSelector=t},confirm:e.onTeamUserSelected}},[t("template",{slot:"reference"},[t("el-input",{staticClass:"mr10",staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:"请选择团队",clearable:""},on:{clear:e.clearSelectedUser},model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}})],1)],2)],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"等级",prop:"groupId"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择等级"},model:{value:e.map.levelId,callback:function(t){e.$set(e.map,"levelId",t)},expression:"map.levelId"}},e._l(e.opts.levelList,function(e,a){return t("el-option",{key:"ulevel_indx_"+a,attrs:{label:e.name,value:e.id}})}),1)],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"用户名",prop:"loginName"}},[t("el-input",{staticClass:"mr10",staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:"请输入用户名",clearable:""},model:{value:e.map.userName,callback:function(t){e.$set(e.map,"userName",t)},expression:"map.userName"}})],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"昵称",prop:"nickName"}},[t("el-input",{staticClass:"mr10",staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:"请输入用户昵称",clearable:""},model:{value:e.map.nickName,callback:function(t){e.$set(e.map,"nickName",t)},expression:"map.nickName"}})],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:"用户类型",prop:"groupId"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择用户类型"},model:{value:e.map.type,callback:function(t){e.$set(e.map,"type",t)},expression:"map.type"}},e._l(e.opts.typeList,function(e,a){return t("el-option",{key:"utype_opt_indx_"+a,attrs:{label:e.name,value:e.value}})}),1)],1),t("el-form-item",{staticClass:"filter-item",attrs:{label:""}},[t("el-button",{attrs:{type:"primary"},on:{click:e.handleCheck}},[e._v("查询")]),t("el-button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,size:"mini","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",border:"",fit:"","highlight-current-row":""}},[t("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50",index:e.getIndex}}),t("el-table-column",{attrs:{label:"账号",prop:"userName",width:"100"}}),t("el-table-column",{attrs:{label:"昵称",prop:"nickName"}}),t("el-table-column",{attrs:{label:"直播间",prop:"roomName",width:"110"}}),t("el-table-column",{attrs:{label:"登录时间",prop:"loginTime"}}),t("el-table-column",{attrs:{label:"最后心跳时间",prop:"heartBeatTime"}}),t("el-table-column",{attrs:{label:"观看（分钟）",prop:"watchLength"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.watchLength(t.row))+" ")]}}])}),t("el-table-column",{attrs:{label:"用户类型",align:"center",prop:"type",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.userTypes[Number(t.row.type)])+" ")]}}])}),t("el-table-column",{attrs:{label:"等级",prop:"levelName",width:"110"}}),t("el-table-column",{attrs:{label:"上级账号",prop:"parentUserName",width:"100"}}),t("el-table-column",{attrs:{label:"所属团队",prop:"deptName"}}),t("el-table-column",{attrs:{label:"登录IP",prop:"clientIp"}}),t("el-table-column",{attrs:{label:"登录地址",prop:"clientAddress"}}),t("el-table-column",{attrs:{label:"#",width:"126"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"danger",size:"mini",plain:""},on:{click:function(t){return e.handleKickedRow(a.row)}}},[e._v("踢出(10分钟)")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.page.pageCurrent,"page-sizes":[10,20,50,100],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalCount,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},i=[],r=a(79187),l=a(56972),o=a(96208),n=a(93756),d=a(95353);const c={name:"Online",components:{UserTreeSelector:r.A},data(){return{selectedValue:void 0,showUserSelector:!1,page:{beginPageIndex:1,pageCurrent:1,endPageIndex:8,pageSize:20,totalCount:0,totalPage:0},userTypes:l.$o,opts:{roomList:[],levelList:[],typeList:l.KO},list:[],map:{roomId:void 0,deptId:void 0,parentId:void 0,levelId:void 0,userName:void 0,nickName:void 0},listLoading:!1}},computed:{...(0,d.L8)(["getUserInfo","getLiveRoomInfo"])},mounted(){this.map.roomId=this.getLiveRoomInfo.id,2!=this.getUserInfo.type||this.getUserInfo.actForUser?this.getUserInfo.actForUser&&2==this.getUserInfo.actForUser.type&&(this.map.$or={parentId:this.getUserInfo.actForUser.userId,userId:this.getUserInfo.actForUser.userId,topToCur_$lk_r:this.getUserInfo.actForUser.topToCur}):this.map.$or={parentId:this.getUserInfo.userId,userId:this.getUserInfo.userId,topToCur_$lk_r:this.getUserInfo.topToCur},this.getAllLevel(),this.listForPage()},methods:{watchLength(e){let t=(new Date).getTime(),a=new Date(e.loginTime).getTime();return Math.round((t-a)/1e3/60)},getIndex(e){return(this.page.pageCurrent-1)*this.page.pageSize+e+1},clearSelectedUser(){this.selectedValue=void 0,this.map.parentId=void 0,this.map.deptId=void 0,this.$refs.userTreeSelector&&this.$refs.userTreeSelector.clearSelected&&this.$refs.userTreeSelector.clearSelected()},onTeamUserSelected(e){e?e.selected&&(e.selected.__isUser?(this.map.$or={parentId:e.selected.userId,userId:e.selected.userId,topToCur_$lk_r:e.selected.topToCur},this.selectedValue=e.selected.userName,this.map.deptId=void 0):(this.map.deptId=e.selected.deptId,this.selectedValue=e.selected.deptName,this.map.parentId=void 0)):this.selectedValue=void 0,this.showUserSelector=!1},getAllLevel(){(0,n.vP)({}).then(e=>{this.opts.levelList=e.data.records})},handleSizeChange(e){this.page.pageSize=e,this.page.pageCurrent=1,this.listForPage()},handleCurrentChange(e){this.page.pageCurrent=e,this.listForPage()},handleReset(){this.map={deptId:void 0,parentId:void 0,levelId:void 0,userName:void 0,nickName:void 0},this.page.pageCurrent=1,this.map.roomId=this.opts.roomList[0].id,this.listForPage()},handleCheck(){this.page.pageCurrent=1,this.listForPage()},listForPage(e=0){this.listLoading=!0;let t=this,a={pageSize:t.page.pageSize,pageNumber:t.page.pageCurrent,...t.map};a.userName&&(a["userName_$lk"]=a.userName,delete a.userName),a.nickName&&(a["nickName_$lk"]=a.nickName,delete a.nickName),a.orderByUserName=!0,(0,o.P0)(a).then(e=>{t.listLoading=!1,t.page.totalCount=Number(e.data.total),t.page.totalPage=Number(e.data.totalPages),t.page.pageCurrent=Number(e.data.pageNum),t.page.pageSize=Number(e.data.pageSize),t.list=e.data.records}).catch(e=>{t.listLoading=!1,console.error(e)})},handleKickedRow(e){if(this.map.roomId&&e.userId){let t={roomId:this.map.roomId,userList:[{userId:e.userId,userName:e.userName}],duration:10};t.roomId&&t.userList&&t.userList.length>0&&(0,o.Xx)(t).then(e=>{this.$modal.msgSuccess("踢出成功"),this.checkedUnKickOuts=[],this.listForPage()})}}}},u=c;var h=a(81656),m=(0,h.A)(u,s,i,!1,null,null,null);const p=m.exports}}]);